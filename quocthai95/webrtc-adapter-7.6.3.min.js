var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(f,l,h){f instanceof String&&(f=String(f));for(var e=f.length,a=0;a<e;a++){var d=f[a];if(l.call(h,d,a,f))return{i:a,v:d}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(f,l,h){f!=Array.prototype&&f!=Object.prototype&&(f[l]=h.value)};$jscomp.getGlobal=function(f){f=["object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global,f];for(var l=0;l<f.length;++l){var h=f[l];if(h&&h.Math==Math)return h}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(f,l,h,e){if(l){h=$jscomp.global;f=f.split(".");for(e=0;e<f.length-1;e++){var a=f[e];a in h||(h[a]={});h=h[a]}f=f[f.length-1];e=h[f];l=l(e);l!=e&&null!=l&&$jscomp.defineProperty(h,f,{configurable:!0,writable:!0,value:l})}};$jscomp.polyfill("Array.prototype.find",function(f){return f?f:function(f,h){return $jscomp.findInternal(this,f,h).v}},"es6","es3");
$jscomp.checkEs6ConformanceViaProxy=function(){try{var f={},l=Object.create(new $jscomp.global.Proxy(f,{get:function(h,e,a){return h==f&&"q"==e&&a==l}}));return!0===l.q}catch(h){return!1}};$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS=!1;$jscomp.ES6_CONFORMANCE=$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS&&$jscomp.checkEs6ConformanceViaProxy();$jscomp.arrayIteratorImpl=function(f){var l=0;return function(){return l<f.length?{done:!1,value:f[l++]}:{done:!0}}};$jscomp.arrayIterator=function(f){return{next:$jscomp.arrayIteratorImpl(f)}};
$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.SymbolClass=function(f,l){this.$jscomp$symbol$id_=f;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:l})};$jscomp.SymbolClass.prototype.toString=function(){return this.$jscomp$symbol$id_};
$jscomp.Symbol=function(){function f(h){if(this instanceof f)throw new TypeError("Symbol is not a constructor");return new $jscomp.SymbolClass($jscomp.SYMBOL_PREFIX+(h||"")+"_"+l++,h)}var l=0;return f}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var f=$jscomp.global.Symbol.iterator;f||(f=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[f]&&$jscomp.defineProperty(Array.prototype,f,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var f=$jscomp.global.Symbol.asyncIterator;f||(f=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("Symbol.asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(f){$jscomp.initSymbolIterator();f={next:f};f[$jscomp.global.Symbol.iterator]=function(){return this};return f};
$jscomp.makeIterator=function(f){var l="undefined"!=typeof Symbol&&Symbol.iterator&&f[Symbol.iterator];return l?l.call(f):$jscomp.arrayIterator(f)};$jscomp.owns=function(f,l){return Object.prototype.hasOwnProperty.call(f,l)};
$jscomp.polyfill("WeakMap",function(f){function l(){if(!f||!Object.seal)return!1;try{var g=Object.seal({}),a=Object.seal({}),b=new f([[g,2],[a,3]]);if(2!=b.get(g)||3!=b.get(a))return!1;b.delete(g);b.set(a,4);return!b.has(g)&&4==b.get(a)}catch(t){return!1}}function h(){}function e(g){var a=typeof g;return"object"===a&&null!==g||"function"===a}function a(a){if(!$jscomp.owns(a,c)){var g=new h;$jscomp.defineProperty(a,c,{value:g})}}function d(g){var b=Object[g];b&&(Object[g]=function(g){if(g instanceof
h)return g;a(g);return b(g)})}if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(f&&$jscomp.ES6_CONFORMANCE)return f}else if(l())return f;var c="$jscomp_hidden_"+Math.random();d("freeze");d("preventExtensions");d("seal");var n=0,b=function(a){this.id_=(n+=Math.random()+1).toString();if(a){a=$jscomp.makeIterator(a);for(var g;!(g=a.next()).done;)g=g.value,this.set(g[0],g[1])}};b.prototype.set=function(g,b){if(!e(g))throw Error("Invalid WeakMap key");a(g);if(!$jscomp.owns(g,c))throw Error("WeakMap key fail: "+
g);g[c][this.id_]=b;return this};b.prototype.get=function(a){return e(a)&&$jscomp.owns(a,c)?a[c][this.id_]:void 0};b.prototype.has=function(a){return e(a)&&$jscomp.owns(a,c)&&$jscomp.owns(a[c],this.id_)};b.prototype.delete=function(a){return e(a)&&$jscomp.owns(a,c)&&$jscomp.owns(a[c],this.id_)?delete a[c][this.id_]:!1};return b},"es6","es3");$jscomp.MapEntry=function(){};
$jscomp.polyfill("Map",function(f){function l(){if($jscomp.ASSUME_NO_NATIVE_MAP||!f||"function"!=typeof f||!f.prototype.entries||"function"!=typeof Object.seal)return!1;try{var a=Object.seal({x:4}),g=new f($jscomp.makeIterator([[a,"s"]]));if("s"!=g.get(a)||1!=g.size||g.get({x:4})||g.set({x:4},"t")!=g||2!=g.size)return!1;var k=g.entries(),c=k.next();if(c.done||c.value[0]!=a||"s"!=c.value[1])return!1;c=k.next();return c.done||4!=c.value[0].x||"t"!=c.value[1]||!k.next().done?!1:!0}catch(t){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(f&&$jscomp.ES6_CONFORMANCE)return f}else if(l())return f;$jscomp.initSymbolIterator();var h=new WeakMap,e=function(a){this.data_={};this.head_=c();this.size=0;if(a){a=$jscomp.makeIterator(a);for(var g;!(g=a.next()).done;)g=g.value,this.set(g[0],g[1])}};e.prototype.set=function(b,g){b=0===b?0:b;var k=a(this,b);k.list||(k.list=this.data_[k.id]=[]);k.entry?k.entry.value=g:(k.entry={next:this.head_,previous:this.head_.previous,head:this.head_,key:b,
value:g},k.list.push(k.entry),this.head_.previous.next=k.entry,this.head_.previous=k.entry,this.size++);return this};e.prototype.delete=function(b){b=a(this,b);return b.entry&&b.list?(b.list.splice(b.index,1),b.list.length||delete this.data_[b.id],b.entry.previous.next=b.entry.next,b.entry.next.previous=b.entry.previous,b.entry.head=null,this.size--,!0):!1};e.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=c();this.size=0};e.prototype.has=function(b){return!!a(this,b).entry};
e.prototype.get=function(b){return(b=a(this,b).entry)&&b.value};e.prototype.entries=function(){return d(this,function(a){return[a.key,a.value]})};e.prototype.keys=function(){return d(this,function(a){return a.key})};e.prototype.values=function(){return d(this,function(a){return a.value})};e.prototype.forEach=function(a,g){for(var b=this.entries(),c;!(c=b.next()).done;)c=c.value,a.call(g,c[1],c[0],this)};e.prototype[Symbol.iterator]=e.prototype.entries;var a=function(a,g){var b=g&&typeof g;"object"==
b||"function"==b?h.has(g)?b=h.get(g):(b=""+ ++n,h.set(g,b)):b="p_"+g;var c=a.data_[b];if(c&&$jscomp.owns(a.data_,b))for(a=0;a<c.length;a++){var d=c[a];if(g!==g&&d.key!==d.key||g===d.key)return{id:b,list:c,index:a,entry:d}}return{id:b,list:c,index:-1,entry:void 0}},d=function(a,g){var b=a.head_;return $jscomp.iteratorPrototype(function(){if(b){for(;b.head!=a.head_;)b=b.previous;for(;b.next!=b.head;)return b=b.next,{done:!1,value:g(b)};b=null}return{done:!0,value:void 0}})},c=function(){var a={};return a.previous=
a.next=a.head=a},n=0;return e},"es6","es3");$jscomp.iteratorFromArray=function(f,l){$jscomp.initSymbolIterator();f instanceof String&&(f+="");var h=0,e={next:function(){if(h<f.length){var a=h++;return{value:l(a,f[a]),done:!1}}e.next=function(){return{done:!0,value:void 0}};return e.next()}};e[Symbol.iterator]=function(){return e};return e};$jscomp.polyfill("Array.prototype.keys",function(f){return f?f:function(){return $jscomp.iteratorFromArray(this,function(f){return f})}},"es6","es3");
$jscomp.FORCE_POLYFILL_PROMISE=!1;
$jscomp.polyfill("Promise",function(f){function l(){this.batch_=null}function h(c){return c instanceof a?c:new a(function(a,b){a(c)})}if(f&&!$jscomp.FORCE_POLYFILL_PROMISE)return f;l.prototype.asyncExecute=function(a){if(null==this.batch_){this.batch_=[];var c=this;this.asyncExecuteFunction(function(){c.executeBatch_()})}this.batch_.push(a)};var e=$jscomp.global.setTimeout;l.prototype.asyncExecuteFunction=function(a){e(a,0)};l.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var a=
this.batch_;this.batch_=[];for(var d=0;d<a.length;++d){var b=a[d];a[d]=null;try{b()}catch(g){this.asyncThrow_(g)}}}this.batch_=null};l.prototype.asyncThrow_=function(a){this.asyncExecuteFunction(function(){throw a;})};var a=function(a){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];var c=this.createResolveAndReject_();try{a(c.resolve,c.reject)}catch(b){c.reject(b)}};a.prototype.createResolveAndReject_=function(){function a(a){return function(g){b||(b=!0,a.call(d,g))}}var d=this,b=!1;
return{resolve:a(this.resolveTo_),reject:a(this.reject_)}};a.prototype.resolveTo_=function(c){if(c===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(c instanceof a)this.settleSameAsPromise_(c);else{a:switch(typeof c){case "object":var d=null!=c;break a;case "function":d=!0;break a;default:d=!1}d?this.resolveToNonPromiseObj_(c):this.fulfill_(c)}};a.prototype.resolveToNonPromiseObj_=function(a){var c=void 0;try{c=a.then}catch(b){this.reject_(b);return}"function"==typeof c?
this.settleSameAsThenable_(c,a):this.fulfill_(a)};a.prototype.reject_=function(a){this.settle_(2,a)};a.prototype.fulfill_=function(a){this.settle_(1,a)};a.prototype.settle_=function(a,d){if(0!=this.state_)throw Error("Cannot settle("+a+", "+d+"): Promise already settled in state"+this.state_);this.state_=a;this.result_=d;this.executeOnSettledCallbacks_()};a.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var a=0;a<this.onSettledCallbacks_.length;++a)d.asyncExecute(this.onSettledCallbacks_[a]);
this.onSettledCallbacks_=null}};var d=new l;a.prototype.settleSameAsPromise_=function(a){var c=this.createResolveAndReject_();a.callWhenSettled_(c.resolve,c.reject)};a.prototype.settleSameAsThenable_=function(a,d){var b=this.createResolveAndReject_();try{a.call(d,b.resolve,b.reject)}catch(g){b.reject(g)}};a.prototype.then=function(c,d){function b(a,b){return"function"==typeof a?function(b){try{g(a(b))}catch(m){k(m)}}:b}var g,k,e=new a(function(a,b){g=a;k=b});this.callWhenSettled_(b(c,g),b(d,k));return e};
a.prototype.catch=function(a){return this.then(void 0,a)};a.prototype.callWhenSettled_=function(a,e){function b(){switch(g.state_){case 1:a(g.result_);break;case 2:e(g.result_);break;default:throw Error("Unexpected state: "+g.state_);}}var g=this;null==this.onSettledCallbacks_?d.asyncExecute(b):this.onSettledCallbacks_.push(b)};a.resolve=h;a.reject=function(c){return new a(function(a,b){b(c)})};a.race=function(c){return new a(function(a,b){for(var g=$jscomp.makeIterator(c),k=g.next();!k.done;k=g.next())h(k.value).callWhenSettled_(a,
b)})};a.all=function(c){var d=$jscomp.makeIterator(c),b=d.next();return b.done?h([]):new a(function(a,c){function g(g){return function(b){k[g]=b;e--;0==e&&a(k)}}var k=[],e=0;do k.push(void 0),e++,h(b.value).callWhenSettled_(g(k.length-1),c),b=d.next();while(!b.done)})};return a},"es6","es3");$jscomp.polyfill("Object.is",function(f){return f?f:function(f,h){return f===h?0!==f||1/f===1/h:f!==f&&h!==h}},"es6","es3");
$jscomp.polyfill("Array.prototype.includes",function(f){return f?f:function(f,h){var e=this;e instanceof String&&(e=String(e));var a=e.length;h=h||0;for(0>h&&(h=Math.max(h+a,0));h<a;h++){var d=e[h];if(d===f||Object.is(d,f))return!0}return!1}},"es7","es3");
$jscomp.checkStringArgs=function(f,l,h){if(null==f)throw new TypeError("The 'this' value for String.prototype."+h+" must not be null or undefined");if(l instanceof RegExp)throw new TypeError("First argument to String.prototype."+h+" must not be a regular expression");return f+""};$jscomp.polyfill("String.prototype.includes",function(f){return f?f:function(f,h){return-1!==$jscomp.checkStringArgs(this,f,"includes").indexOf(f,h||0)}},"es6","es3");
$jscomp.assign="function"==typeof Object.assign?Object.assign:function(f,l){for(var h=1;h<arguments.length;h++){var e=arguments[h];if(e)for(var a in e)$jscomp.owns(e,a)&&(f[a]=e[a])}return f};$jscomp.polyfill("Object.assign",function(f){return f||$jscomp.assign},"es6","es3");
$jscomp.polyfill("String.prototype.startsWith",function(f){return f?f:function(f,h){var e=$jscomp.checkStringArgs(this,f,"startsWith");f+="";var a=e.length,d=f.length;h=Math.max(0,Math.min(h|0,e.length));for(var c=0;c<d&&h<a;)if(e[h++]!=f[c++])return!1;return c>=d}},"es6","es3");
$jscomp.polyfill("Promise.prototype.finally",function(f){return f?f:function(f){return this.then(function(h){return Promise.resolve(f()).then(function(){return h})},function(h){return Promise.resolve(f()).then(function(){throw h;})})}},"es9","es3");
$jscomp.polyfill("String.prototype.endsWith",function(f){return f?f:function(f,h){var e=$jscomp.checkStringArgs(this,f,"endsWith");f+="";void 0===h&&(h=e.length);h=Math.max(0,Math.min(h|0,e.length));for(var a=f.length;0<a&&0<h;)if(e[--h]!=f[--a])return!1;return 0>=a}},"es6","es3");
(function(f){"object"===typeof exports&&"undefined"!==typeof module?module.exports=f():"function"===typeof define&&define.amd?define([],f):("undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:this).adapter=f()})(function(){return function(){function f(l,h,e){function a(c,b){if(!h[c]){if(!l[c]){var g="function"==typeof require&&require;if(!b&&g)return g(c,!0);if(d)return d(c,!0);b=Error("Cannot find module '"+c+"'");throw b.code="MODULE_NOT_FOUND",b;
}b=h[c]={exports:{}};l[c][0].call(b.exports,function(g){return a(l[c][1][g]||g)},b,b.exports,f,l,h,e)}return h[c].exports}for(var d="function"==typeof require&&require,c=0;c<e.length;c++)a(e[c]);return a}return f}()({1:[function(f,l,h){f=f("./adapter_factory.js");f=(0,f.adapterFactory)({window:window});l.exports=f},{"./adapter_factory.js":2}],2:[function(f,l,h){function e(a){if(a&&a.__esModule)return a;var g={};if(null!=a)for(var b in a)Object.prototype.hasOwnProperty.call(a,b)&&(g[b]=a[b]);g.default=
a;return g}Object.defineProperty(h,"__esModule",{value:!0});h.adapterFactory=function(){var k=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).window,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimEdge:!0,shimSafari:!0},f=a.log,w=a.detectBrowser(k),h={browserDetails:w,commonShim:g,extractVersion:a.extractVersion,disableLog:a.disableLog,disableWarnings:a.disableWarnings};switch(w.browser){case "chrome":if(!d||!d.shimPeerConnection||!e.shimChrome){f("Chrome shim is not included in this adapter release.");
break}if(null===w.version){f("Chrome shim can not determine version, not shimming.");break}f("adapter.js shimming chrome.");h.browserShim=d;d.shimGetUserMedia(k);d.shimMediaStream(k);d.shimPeerConnection(k);d.shimOnTrack(k);d.shimAddTrackRemoveTrack(k);d.shimGetSendersWithDtmf(k);d.shimGetStats(k);d.shimSenderReceiverGetStats(k);d.fixNegotiationNeeded(k);g.shimRTCIceCandidate(k);g.shimConnectionState(k);g.shimMaxMessageSize(k);g.shimSendThrowTypeError(k);g.removeAllowExtmapMixed(k);break;case "firefox":if(!n||
!n.shimPeerConnection||!e.shimFirefox){f("Firefox shim is not included in this adapter release.");break}f("adapter.js shimming firefox.");h.browserShim=n;n.shimGetUserMedia(k);n.shimPeerConnection(k);n.shimOnTrack(k);n.shimRemoveStream(k);n.shimSenderGetStats(k);n.shimReceiverGetStats(k);n.shimRTCDataChannel(k);n.shimAddTransceiver(k);n.shimGetParameters(k);n.shimCreateOffer(k);n.shimCreateAnswer(k);g.shimRTCIceCandidate(k);g.shimConnectionState(k);g.shimMaxMessageSize(k);g.shimSendThrowTypeError(k);
break;case "edge":if(!c||!c.shimPeerConnection||!e.shimEdge){f("MS edge shim is not included in this adapter release.");break}f("adapter.js shimming edge.");h.browserShim=c;c.shimGetUserMedia(k);c.shimGetDisplayMedia(k);c.shimPeerConnection(k);c.shimReplaceTrack(k);g.shimMaxMessageSize(k);g.shimSendThrowTypeError(k);break;case "safari":if(!b||!e.shimSafari){f("Safari shim is not included in this adapter release.");break}f("adapter.js shimming safari.");h.browserShim=b;b.shimRTCIceServerUrls(k);b.shimCreateOfferLegacy(k);
b.shimCallbacksAPI(k);b.shimLocalStreamsAPI(k);b.shimRemoteStreamsAPI(k);b.shimTrackEventTransceiver(k);b.shimGetUserMedia(k);b.shimAudioContext(k);g.shimRTCIceCandidate(k);g.shimMaxMessageSize(k);g.shimSendThrowTypeError(k);g.removeAllowExtmapMixed(k);break;default:f("Unsupported browser!")}return h};l=f("./utils");var a=e(l);l=f("./chrome/chrome_shim");var d=e(l);l=f("./edge/edge_shim");var c=e(l);l=f("./firefox/firefox_shim");var n=e(l);l=f("./safari/safari_shim");var b=e(l);f=f("./common_shim");
var g=e(f)},{"./chrome/chrome_shim":3,"./common_shim":6,"./edge/edge_shim":7,"./firefox/firefox_shim":11,"./safari/safari_shim":14,"./utils":15}],3:[function(f,l,h){function e(a,b,c){b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c;return a}function a(a){a.RTCPeerConnection.prototype.getLocalStreams=function(){var a=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{};return Object.keys(this._shimmedLocalStreams).map(function(b){return a._shimmedLocalStreams[b][0]})};
var b=a.RTCPeerConnection.prototype.addTrack;a.RTCPeerConnection.prototype.addTrack=function(a,g){if(!g)return b.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};var c=b.apply(this,arguments);this._shimmedLocalStreams[g.id]?-1===this._shimmedLocalStreams[g.id].indexOf(c)&&this._shimmedLocalStreams[g.id].push(c):this._shimmedLocalStreams[g.id]=[g,c];return c};var g=a.RTCPeerConnection.prototype.addStream;a.RTCPeerConnection.prototype.addStream=function(a){var b=this;this._shimmedLocalStreams=
this._shimmedLocalStreams||{};a.getTracks().forEach(function(a){if(b.getSenders().find(function(b){return b.track===a}))throw new DOMException("Track already exists.","InvalidAccessError");});var c=this.getSenders();g.apply(this,arguments);var k=this.getSenders().filter(function(a){return-1===c.indexOf(a)});this._shimmedLocalStreams[a.id]=[a].concat(k)};var c=a.RTCPeerConnection.prototype.removeStream;a.RTCPeerConnection.prototype.removeStream=function(a){this._shimmedLocalStreams=this._shimmedLocalStreams||
{};delete this._shimmedLocalStreams[a.id];return c.apply(this,arguments)};var d=a.RTCPeerConnection.prototype.removeTrack;a.RTCPeerConnection.prototype.removeTrack=function(a){var b=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{};a&&Object.keys(this._shimmedLocalStreams).forEach(function(g){var c=b._shimmedLocalStreams[g].indexOf(a);-1!==c&&b._shimmedLocalStreams[g].splice(c,1);1===b._shimmedLocalStreams[g].length&&delete b._shimmedLocalStreams[g]});return d.apply(this,arguments)}}Object.defineProperty(h,
"__esModule",{value:!0});h.shimGetDisplayMedia=h.shimGetUserMedia=void 0;var d="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},c=f("./getusermedia");Object.defineProperty(h,"shimGetUserMedia",{enumerable:!0,get:function(){return c.shimGetUserMedia}});var n=f("./getdisplaymedia");Object.defineProperty(h,"shimGetDisplayMedia",{enumerable:!0,get:function(){return n.shimGetDisplayMedia}});
h.shimMediaStream=function(a){a.MediaStream=a.MediaStream||a.webkitMediaStream};h.shimOnTrack=function(a){if("object"!==("undefined"===typeof a?"undefined":d(a))||!a.RTCPeerConnection||"ontrack"in a.RTCPeerConnection.prototype)b.wrapPeerConnectionEvent(a,"track",function(a){a.transceiver||Object.defineProperty(a,"transceiver",{value:{receiver:a.receiver}});return a});else{Object.defineProperty(a.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(a){this._ontrack&&
this.removeEventListener("track",this._ontrack);this.addEventListener("track",this._ontrack=a)},enumerable:!0,configurable:!0});var g=a.RTCPeerConnection.prototype.setRemoteDescription;a.RTCPeerConnection.prototype.setRemoteDescription=function(){var b=this;this._ontrackpoly||(this._ontrackpoly=function(g){g.stream.addEventListener("addtrack",function(c){var k=void 0;k=a.RTCPeerConnection.prototype.getReceivers?b.getReceivers().find(function(a){return a.track&&a.track.id===c.track.id}):{track:c.track};
var d=new Event("track");d.track=c.track;d.receiver=k;d.transceiver={receiver:k};d.streams=[g.stream];b.dispatchEvent(d)});g.stream.getTracks().forEach(function(c){var k=void 0;k=a.RTCPeerConnection.prototype.getReceivers?b.getReceivers().find(function(a){return a.track&&a.track.id===c.id}):{track:c};var d=new Event("track");d.track=c;d.receiver=k;d.transceiver={receiver:k};d.streams=[g.stream];b.dispatchEvent(d)})},this.addEventListener("addstream",this._ontrackpoly));return g.apply(this,arguments)}}};
h.shimGetSendersWithDtmf=function(a){if("object"===("undefined"===typeof a?"undefined":d(a))&&a.RTCPeerConnection&&!("getSenders"in a.RTCPeerConnection.prototype)&&"createDTMFSender"in a.RTCPeerConnection.prototype){var b=function(a,b){return{track:b,get dtmf(){void 0===this._dtmf&&(this._dtmf="audio"===b.kind?a.createDTMFSender(b):null);return this._dtmf},_pc:a}};if(!a.RTCPeerConnection.prototype.getSenders){a.RTCPeerConnection.prototype.getSenders=function(){this._senders=this._senders||[];return this._senders.slice()};
var c=a.RTCPeerConnection.prototype.addTrack;a.RTCPeerConnection.prototype.addTrack=function(a,g){var k=c.apply(this,arguments);k||(k=b(this,a),this._senders.push(k));return k};var g=a.RTCPeerConnection.prototype.removeTrack;a.RTCPeerConnection.prototype.removeTrack=function(a){g.apply(this,arguments);var b=this._senders.indexOf(a);-1!==b&&this._senders.splice(b,1)}}var e=a.RTCPeerConnection.prototype.addStream;a.RTCPeerConnection.prototype.addStream=function(a){var c=this;this._senders=this._senders||
[];e.apply(this,[a]);a.getTracks().forEach(function(a){c._senders.push(b(c,a))})};var f=a.RTCPeerConnection.prototype.removeStream;a.RTCPeerConnection.prototype.removeStream=function(a){var b=this;this._senders=this._senders||[];f.apply(this,[a]);a.getTracks().forEach(function(a){var c=b._senders.find(function(b){return b.track===a});c&&b._senders.splice(b._senders.indexOf(c),1)})}}else if("object"===("undefined"===typeof a?"undefined":d(a))&&a.RTCPeerConnection&&"getSenders"in a.RTCPeerConnection.prototype&&
"createDTMFSender"in a.RTCPeerConnection.prototype&&a.RTCRtpSender&&!("dtmf"in a.RTCRtpSender.prototype)){var h=a.RTCPeerConnection.prototype.getSenders;a.RTCPeerConnection.prototype.getSenders=function(){var a=this,b=h.apply(this,[]);b.forEach(function(b){return b._pc=a});return b};Object.defineProperty(a.RTCRtpSender.prototype,"dtmf",{get:function(){void 0===this._dtmf&&(this._dtmf="audio"===this.track.kind?this._pc.createDTMFSender(this.track):null);return this._dtmf}})}};h.shimGetStats=function(a){if(a.RTCPeerConnection){var b=
a.RTCPeerConnection.prototype.getStats;a.RTCPeerConnection.prototype.getStats=function(){var a=this,c=Array.prototype.slice.call(arguments),g=c[0],k=c[1];c=c[2];if(0<arguments.length&&"function"===typeof g)return b.apply(this,arguments);if(0===b.length&&(0===arguments.length||"function"!==typeof g))return b.apply(this,[]);var d=function(a){var b={};a.result().forEach(function(a){var c={id:a.id,timestamp:a.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[a.type]||
a.type};a.names().forEach(function(b){c[b]=a.stat(b)});b[c.id]=c});return b},e=function(a){return new Map(Object.keys(a).map(function(b){return[b,a[b]]}))};return 2<=arguments.length?b.apply(this,[function(a){k(e(d(a)))},g]):(new Promise(function(c,g){b.apply(a,[function(a){c(e(d(a)))},g])})).then(k,c)}}};h.shimSenderReceiverGetStats=function(a){if("object"===("undefined"===typeof a?"undefined":d(a))&&a.RTCPeerConnection&&a.RTCRtpSender&&a.RTCRtpReceiver){if(!("getStats"in a.RTCRtpSender.prototype)){var c=
a.RTCPeerConnection.prototype.getSenders;c&&(a.RTCPeerConnection.prototype.getSenders=function(){var a=this,b=c.apply(this,[]);b.forEach(function(b){return b._pc=a});return b});var g=a.RTCPeerConnection.prototype.addTrack;g&&(a.RTCPeerConnection.prototype.addTrack=function(){var a=g.apply(this,arguments);a._pc=this;return a});a.RTCRtpSender.prototype.getStats=function(){var a=this;return this._pc.getStats().then(function(c){return b.filterStats(c,a.track,!0)})}}if(!("getStats"in a.RTCRtpReceiver.prototype)){var e=
a.RTCPeerConnection.prototype.getReceivers;e&&(a.RTCPeerConnection.prototype.getReceivers=function(){var a=this,b=e.apply(this,[]);b.forEach(function(b){return b._pc=a});return b});b.wrapPeerConnectionEvent(a,"track",function(a){a.receiver._pc=a.srcElement;return a});a.RTCRtpReceiver.prototype.getStats=function(){var a=this;return this._pc.getStats().then(function(c){return b.filterStats(c,a.track,!1)})}}if("getStats"in a.RTCRtpSender.prototype&&"getStats"in a.RTCRtpReceiver.prototype){var f=a.RTCPeerConnection.prototype.getStats;
a.RTCPeerConnection.prototype.getStats=function(){if(0<arguments.length&&arguments[0]instanceof a.MediaStreamTrack){var b=arguments[0],c=void 0,g=void 0,k=void 0;this.getSenders().forEach(function(a){a.track===b&&(c?k=!0:c=a)});this.getReceivers().forEach(function(a){a.track===b&&(g?k=!0:g=a);return a.track===b});return k||c&&g?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):c?c.getStats():g?g.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.",
"InvalidAccessError"))}return f.apply(this,arguments)}}}};h.shimAddTrackRemoveTrackWithNative=a;h.shimAddTrackRemoveTrack=function(c){function g(a,b){var c=b.sdp;Object.keys(a._reverseStreams||[]).forEach(function(b){b=a._reverseStreams[b];c=c.replace(new RegExp(a._streams[b.id].id,"g"),b.id)});return new RTCSessionDescription({type:b.type,sdp:c})}function d(a,b){var c=b.sdp;Object.keys(a._reverseStreams||[]).forEach(function(b){b=a._reverseStreams[b];c=c.replace(new RegExp(b.id,"g"),a._streams[b.id].id)});
return new RTCSessionDescription({type:b.type,sdp:c})}if(c.RTCPeerConnection){var f=b.detectBrowser(c);if(c.RTCPeerConnection.prototype.addTrack&&65<=f.version)return a(c);var w=c.RTCPeerConnection.prototype.getLocalStreams;c.RTCPeerConnection.prototype.getLocalStreams=function(){var a=this,b=w.apply(this);this._reverseStreams=this._reverseStreams||{};return b.map(function(b){return a._reverseStreams[b.id]})};var h=c.RTCPeerConnection.prototype.addStream;c.RTCPeerConnection.prototype.addStream=function(a){var b=
this;this._streams=this._streams||{};this._reverseStreams=this._reverseStreams||{};a.getTracks().forEach(function(a){if(b.getSenders().find(function(b){return b.track===a}))throw new DOMException("Track already exists.","InvalidAccessError");});if(!this._reverseStreams[a.id]){var g=new c.MediaStream(a.getTracks());this._streams[a.id]=g;this._reverseStreams[g.id]=a;a=g}h.apply(this,[a])};var n=c.RTCPeerConnection.prototype.removeStream;c.RTCPeerConnection.prototype.removeStream=function(a){this._streams=
this._streams||{};this._reverseStreams=this._reverseStreams||{};n.apply(this,[this._streams[a.id]||a]);delete this._reverseStreams[this._streams[a.id]?this._streams[a.id].id:a.id];delete this._streams[a.id]};c.RTCPeerConnection.prototype.addTrack=function(a,b){var g=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");var k=[].slice.call(arguments,1);if(1!==k.length||!k[0].getTracks().find(function(b){return b===a}))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.",
"NotSupportedError");if(this.getSenders().find(function(b){return b.track===a}))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{};this._reverseStreams=this._reverseStreams||{};(k=this._streams[b.id])?(k.addTrack(a),Promise.resolve().then(function(){g.dispatchEvent(new Event("negotiationneeded"))})):(k=new c.MediaStream([a]),this._streams[b.id]=k,this._reverseStreams[k.id]=b,this.addStream(k));return this.getSenders().find(function(b){return b.track===
a})};["createOffer","createAnswer"].forEach(function(a){var b=c.RTCPeerConnection.prototype[a],k=e({},a,function(){var a=this,c=arguments;return arguments.length&&"function"===typeof arguments[0]?b.apply(this,[function(b){b=g(a,b);c[0].apply(null,[b])},function(a){c[1]&&c[1].apply(null,a)},arguments[2]]):b.apply(this,arguments).then(function(b){return g(a,b)})});c.RTCPeerConnection.prototype[a]=k[a]});var y=c.RTCPeerConnection.prototype.setLocalDescription;c.RTCPeerConnection.prototype.setLocalDescription=
function(){if(!arguments.length||!arguments[0].type)return y.apply(this,arguments);arguments[0]=d(this,arguments[0]);return y.apply(this,arguments)};var q=Object.getOwnPropertyDescriptor(c.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(c.RTCPeerConnection.prototype,"localDescription",{get:function(){var a=q.get.apply(this);return""===a.type?a:g(this,a)}});c.RTCPeerConnection.prototype.removeTrack=function(a){var b=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.",
"InvalidStateError");if(!a._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(a._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};var c=void 0;Object.keys(this._streams).forEach(function(g){b._streams[g].getTracks().find(function(b){return a.track===b})&&(c=b._streams[g])});c&&(1===c.getTracks().length?this.removeStream(this._reverseStreams[c.id]):
c.removeTrack(a.track),this.dispatchEvent(new Event("negotiationneeded")))}}};h.shimPeerConnection=function(a){var c=b.detectBrowser(a);!a.RTCPeerConnection&&a.webkitRTCPeerConnection&&(a.RTCPeerConnection=a.webkitRTCPeerConnection);if(a.RTCPeerConnection){var g=0===a.RTCPeerConnection.prototype.addIceCandidate.length;53>c.version&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(b){var c=a.RTCPeerConnection.prototype[b],g=e({},b,function(){arguments[0]=new ("addIceCandidate"===
b?a.RTCIceCandidate:a.RTCSessionDescription)(arguments[0]);return c.apply(this,arguments)});a.RTCPeerConnection.prototype[b]=g[b]});var d=a.RTCPeerConnection.prototype.addIceCandidate;a.RTCPeerConnection.prototype.addIceCandidate=function(){return g||arguments[0]?78>c.version&&arguments[0]&&""===arguments[0].candidate?Promise.resolve():d.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}}};h.fixNegotiationNeeded=function(a){var c=b.detectBrowser(a);b.wrapPeerConnectionEvent(a,
"negotiationneeded",function(a){var b=a.target;if(!(72>c.version||b.getConfiguration&&"plan-b"===b.getConfiguration().sdpSemantics)||"stable"===b.signalingState)return a})};var b=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);b.default=a;return b}(f("../utils.js"))},{"../utils.js":15,"./getdisplaymedia":4,"./getusermedia":5}],4:[function(f,l,h){Object.defineProperty(h,"__esModule",{value:!0});h.shimGetDisplayMedia=
function(e,a){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||!e.navigator.mediaDevices||("function"!==typeof a?console.error("shimGetDisplayMedia: getSourceId argument is not a function"):e.navigator.mediaDevices.getDisplayMedia=function(d){return a(d).then(function(a){var c=d.video&&d.video.width,b=d.video&&d.video.height;d.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:a,maxFrameRate:d.video&&d.video.frameRate||3}};c&&(d.video.mandatory.maxWidth=c);b&&
(d.video.mandatory.maxHeight=b);return e.navigator.mediaDevices.getUserMedia(d)})})}},{}],5:[function(f,l,h){Object.defineProperty(h,"__esModule",{value:!0});var e="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};h.shimGetUserMedia=function(c){var f=c&&c.navigator;if(f.mediaDevices){var b=a.detectBrowser(c),g=function(a){if("object"!==("undefined"===
typeof a?"undefined":e(a))||a.mandatory||a.optional)return a;var b={};Object.keys(a).forEach(function(c){if("require"!==c&&"advanced"!==c&&"mediaSource"!==c){var g="object"===e(a[c])?a[c]:{ideal:a[c]};void 0!==g.exact&&"number"===typeof g.exact&&(g.min=g.max=g.exact);var k=function(a,b){return a?a+b.charAt(0).toUpperCase()+b.slice(1):"deviceId"===b?"sourceId":b};if(void 0!==g.ideal){b.optional=b.optional||[];var d={};"number"===typeof g.ideal?(d[k("min",c)]=g.ideal,b.optional.push(d),d={},d[k("max",
c)]=g.ideal):d[k("",c)]=g.ideal;b.optional.push(d)}void 0!==g.exact&&"number"!==typeof g.exact?(b.mandatory=b.mandatory||{},b.mandatory[k("",c)]=g.exact):["min","max"].forEach(function(a){void 0!==g[a]&&(b.mandatory=b.mandatory||{},b.mandatory[k(a,c)]=g[a])})}});a.advanced&&(b.optional=(b.optional||[]).concat(a.advanced));return b},k=function(a,c){if(61<=b.version)return c(a);if((a=JSON.parse(JSON.stringify(a)))&&"object"===e(a.audio)){var k=function(a,b,c){b in a&&!(c in a)&&(a[c]=a[b],delete a[b])};
a=JSON.parse(JSON.stringify(a));k(a.audio,"autoGainControl","googAutoGainControl");k(a.audio,"noiseSuppression","googNoiseSuppression");a.audio=g(a.audio)}if(a&&"object"===e(a.video)){var h=a.video.facingMode;h=h&&("object"===("undefined"===typeof h?"undefined":e(h))?h:{ideal:h});k=66>b.version;if(!(!h||"user"!==h.exact&&"environment"!==h.exact&&"user"!==h.ideal&&"environment"!==h.ideal||f.mediaDevices.getSupportedConstraints&&f.mediaDevices.getSupportedConstraints().facingMode&&!k)){delete a.video.facingMode;
var q=void 0;if("environment"===h.exact||"environment"===h.ideal)q=["back","rear"];else if("user"===h.exact||"user"===h.ideal)q=["front"];if(q)return f.mediaDevices.enumerateDevices().then(function(b){b=b.filter(function(a){return"videoinput"===a.kind});var k=b.find(function(a){return q.some(function(b){return a.label.toLowerCase().includes(b)})});!k&&b.length&&q.includes("back")&&(k=b[b.length-1]);k&&(a.video.deviceId=h.exact?{exact:k.deviceId}:{ideal:k.deviceId});a.video=g(a.video);d("chrome: "+
JSON.stringify(a));return c(a)})}a.video=g(a.video)}d("chrome: "+JSON.stringify(a));return c(a)},h=function(a){return 64<=b.version?a:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",
ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[a.name]||a.name,message:a.message,constraint:a.constraint||a.constraintName,toString:function(){return this.name+(this.message&&": ")+this.message}}};f.getUserMedia=function(a,b,c){k(a,function(a){f.webkitGetUserMedia(a,b,function(a){c&&c(h(a))})})}.bind(f);if(f.mediaDevices.getUserMedia){var t=f.mediaDevices.getUserMedia.bind(f.mediaDevices);f.mediaDevices.getUserMedia=function(a){return k(a,function(a){return t(a).then(function(b){if(a.audio&&
!b.getAudioTracks().length||a.video&&!b.getVideoTracks().length)throw b.getTracks().forEach(function(a){a.stop()}),new DOMException("","NotFoundError");return b},function(a){return Promise.reject(h(a))})})}}}};var a=function(a){if(a&&a.__esModule)return a;var c={};if(null!=a)for(var b in a)Object.prototype.hasOwnProperty.call(a,b)&&(c[b]=a[b]);c.default=a;return c}(f("../utils.js")),d=a.log},{"../utils.js":15}],6:[function(f,l,h){Object.defineProperty(h,"__esModule",{value:!0});var e="function"===
typeof Symbol&&"symbol"===typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};h.shimRTCIceCandidate=function(c){if(c.RTCIceCandidate&&!(c.RTCIceCandidate&&"foundation"in c.RTCIceCandidate.prototype)){var f=c.RTCIceCandidate;c.RTCIceCandidate=function(b){"object"===("undefined"===typeof b?"undefined":e(b))&&b.candidate&&0===b.candidate.indexOf("a=")&&(b=JSON.parse(JSON.stringify(b)),b.candidate=
b.candidate.substr(2));if(b.candidate&&b.candidate.length){var c=new f(b);b=a.default.parseCandidate(b.candidate);var k=Object.assign(c,b);k.toJSON=function(){return{candidate:k.candidate,sdpMid:k.sdpMid,sdpMLineIndex:k.sdpMLineIndex,usernameFragment:k.usernameFragment}};return k}return new f(b)};c.RTCIceCandidate.prototype=f.prototype;d.wrapPeerConnectionEvent(c,"icecandidate",function(a){a.candidate&&Object.defineProperty(a,"candidate",{value:new c.RTCIceCandidate(a.candidate),writable:"false"});
return a})}};h.shimMaxMessageSize=function(c){if(c.RTCPeerConnection){var e=d.detectBrowser(c);"sctp"in c.RTCPeerConnection.prototype||Object.defineProperty(c.RTCPeerConnection.prototype,"sctp",{get:function(){return"undefined"===typeof this._sctp?null:this._sctp}});var b=function(b){if(!b||!b.sdp)return!1;b=a.default.splitSections(b.sdp);b.shift();return b.some(function(b){return(b=a.default.parseMLine(b))&&"application"===b.kind&&-1!==b.protocol.indexOf("SCTP")})},g=function(a){a=a.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);
if(null===a||2>a.length)return-1;a=parseInt(a[1],10);return a!==a?-1:a},k=function(a){var b=65536;"firefox"===e.browser&&(b=57>e.version?-1===a?16384:2147483637:60>e.version?57===e.version?65535:65536:2147483637);return b},f=function(b,c){var g=65536;"firefox"===e.browser&&57===e.version&&(g=65535);b=a.default.matchPrefix(b.sdp,"a=max-message-size:");0<b.length?g=parseInt(b[0].substr(19),10):"firefox"===e.browser&&-1!==c&&(g=2147483637);return g},h=c.RTCPeerConnection.prototype.setRemoteDescription;
c.RTCPeerConnection.prototype.setRemoteDescription=function(){this._sctp=null;"chrome"===e.browser&&76<=e.version&&"plan-b"===this.getConfiguration().sdpSemantics&&Object.defineProperty(this,"sctp",{get:function(){return"undefined"===typeof this._sctp?null:this._sctp},enumerable:!0,configurable:!0});if(b(arguments[0])){var a=g(arguments[0]),c=k(a);a=f(arguments[0],a);var d=void 0;d=0===c&&0===a?Number.POSITIVE_INFINITY:0===c||0===a?Math.max(c,a):Math.min(c,a);c={};Object.defineProperty(c,"maxMessageSize",
{get:function(){return d}});this._sctp=c}return h.apply(this,arguments)}}};h.shimSendThrowTypeError=function(a){function c(a,b){var c=a.send;a.send=function(){var g=arguments[0];g=g.length||g.size||g.byteLength;if("open"===a.readyState&&b.sctp&&g>b.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+b.sctp.maxMessageSize+" bytes)");return c.apply(a,arguments)}}if(a.RTCPeerConnection&&"createDataChannel"in a.RTCPeerConnection.prototype){var b=a.RTCPeerConnection.prototype.createDataChannel;
a.RTCPeerConnection.prototype.createDataChannel=function(){var a=b.apply(this,arguments);c(a,this);return a};d.wrapPeerConnectionEvent(a,"datachannel",function(a){c(a.channel,a.target);return a})}};h.shimConnectionState=function(a){if(a.RTCPeerConnection&&!("connectionState"in a.RTCPeerConnection.prototype)){var c=a.RTCPeerConnection.prototype;Object.defineProperty(c,"connectionState",{get:function(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},
enumerable:!0,configurable:!0});Object.defineProperty(c,"onconnectionstatechange",{get:function(){return this._onconnectionstatechange||null},set:function(a){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange);a&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=a)},enumerable:!0,configurable:!0});["setLocalDescription","setRemoteDescription"].forEach(function(a){var b=c[a];
c[a]=function(){this._connectionstatechangepoly||(this._connectionstatechangepoly=function(a){var b=a.target;if(b._lastConnectionState!==b.connectionState){b._lastConnectionState=b.connectionState;var c=new Event("connectionstatechange",a);b.dispatchEvent(c)}return a},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly));return b.apply(this,arguments)}})}};h.removeAllowExtmapMixed=function(a){if(a.RTCPeerConnection){var c=d.detectBrowser(a);if(!("chrome"===c.browser&&
71<=c.version||"safari"===c.browser&&605<=c.version)){var b=a.RTCPeerConnection.prototype.setRemoteDescription;a.RTCPeerConnection.prototype.setRemoteDescription=function(a){a&&a.sdp&&-1!==a.sdp.indexOf("\na=extmap-allow-mixed")&&(a.sdp=a.sdp.split("\n").filter(function(a){return"a=extmap-allow-mixed"!==a.trim()}).join("\n"));return b.apply(this,arguments)}}}};var a=(l=f("sdp"))&&l.__esModule?l:{default:l},d=function(a){if(a&&a.__esModule)return a;var c={};if(null!=a)for(var b in a)Object.prototype.hasOwnProperty.call(a,
b)&&(c[b]=a[b]);c.default=a;return c}(f("./utils"))},{"./utils":15,sdp:17}],7:[function(f,l,h){Object.defineProperty(h,"__esModule",{value:!0});h.shimGetDisplayMedia=h.shimGetUserMedia=void 0;var e=f("./getusermedia");Object.defineProperty(h,"shimGetUserMedia",{enumerable:!0,get:function(){return e.shimGetUserMedia}});var a=f("./getdisplaymedia");Object.defineProperty(h,"shimGetDisplayMedia",{enumerable:!0,get:function(){return a.shimGetDisplayMedia}});h.shimPeerConnection=function(a){var b=d.detectBrowser(a);
if(a.RTCIceGatherer&&(a.RTCIceCandidate||(a.RTCIceCandidate=function(a){return a}),a.RTCSessionDescription||(a.RTCSessionDescription=function(a){return a}),15025>b.version)){var k=Object.getOwnPropertyDescriptor(a.MediaStreamTrack.prototype,"enabled");Object.defineProperty(a.MediaStreamTrack.prototype,"enabled",{set:function(a){k.set.call(this,a);var b=new Event("enabled");b.enabled=a;this.dispatchEvent(b)}})}!a.RTCRtpSender||"dtmf"in a.RTCRtpSender.prototype||Object.defineProperty(a.RTCRtpSender.prototype,
"dtmf",{get:function(){void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=new a.RTCDtmfSender(this):"video"===this.track.kind&&(this._dtmf=null));return this._dtmf}});a.RTCDtmfSender&&!a.RTCDTMFSender&&(a.RTCDTMFSender=a.RTCDtmfSender);var e=(0,n.default)(a,b.version);a.RTCPeerConnection=function(a){a&&a.iceServers&&(a.iceServers=(0,c.filterIceServers)(a.iceServers,b.version),d.log("ICE servers after filtering:",a.iceServers));return new e(a)};a.RTCPeerConnection.prototype=e.prototype};h.shimReplaceTrack=
function(a){!a.RTCRtpSender||"replaceTrack"in a.RTCRtpSender.prototype||(a.RTCRtpSender.prototype.replaceTrack=a.RTCRtpSender.prototype.setTrack)};var d=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);b.default=a;return b}(f("../utils")),c=f("./filtericeservers"),n=(f=f("rtcpeerconnection-shim"))&&f.__esModule?f:{default:f}},{"../utils":15,"./filtericeservers":8,"./getdisplaymedia":9,"./getusermedia":10,"rtcpeerconnection-shim":16}],
8:[function(f,l,h){Object.defineProperty(h,"__esModule",{value:!0});h.filterIceServers=function(a,d){var c=!1;a=JSON.parse(JSON.stringify(a));return a.filter(function(a){if(a&&(a.urls||a.url)){var b=a.urls||a.url;a.url&&!a.urls&&e.deprecated("RTCIceServer.url","RTCIceServer.urls");var g="string"===typeof b;g&&(b=[b]);b=b.filter(function(a){return 0===a.indexOf("stun:")?!1:(a=a.startsWith("turn")&&!a.startsWith("turn:[")&&a.includes("transport=udp"))&&!c?c=!0:a&&!c});delete a.url;a.urls=g?b[0]:b;return!!b.length}})};
var e=function(a){if(a&&a.__esModule)return a;var d={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(d[c]=a[c]);d.default=a;return d}(f("../utils"))},{"../utils":15}],9:[function(f,l,h){Object.defineProperty(h,"__esModule",{value:!0});h.shimGetDisplayMedia=function(e){"getDisplayMedia"in e.navigator&&e.navigator.mediaDevices&&!(e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices)&&(e.navigator.mediaDevices.getDisplayMedia=e.navigator.getDisplayMedia.bind(e.navigator))}},
{}],10:[function(f,l,h){Object.defineProperty(h,"__esModule",{value:!0});h.shimGetUserMedia=function(e){e=e&&e.navigator;var a=function(a){return{name:{PermissionDeniedError:"NotAllowedError"}[a.name]||a.name,message:a.message,constraint:a.constraint,toString:function(){return this.name}}},d=e.mediaDevices.getUserMedia.bind(e.mediaDevices);e.mediaDevices.getUserMedia=function(c){return d(c).catch(function(c){return Promise.reject(a(c))})}}},{}],11:[function(f,l,h){function e(a,c,k){c in a?Object.defineProperty(a,
c,{value:k,enumerable:!0,configurable:!0,writable:!0}):a[c]=k;return a}Object.defineProperty(h,"__esModule",{value:!0});h.shimGetDisplayMedia=h.shimGetUserMedia=void 0;var a="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},d=f("./getusermedia");Object.defineProperty(h,"shimGetUserMedia",{enumerable:!0,get:function(){return d.shimGetUserMedia}});
var c=f("./getdisplaymedia");Object.defineProperty(h,"shimGetDisplayMedia",{enumerable:!0,get:function(){return c.shimGetDisplayMedia}});h.shimOnTrack=function(b){"object"===("undefined"===typeof b?"undefined":a(b))&&b.RTCTrackEvent&&"receiver"in b.RTCTrackEvent.prototype&&!("transceiver"in b.RTCTrackEvent.prototype)&&Object.defineProperty(b.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})};h.shimPeerConnection=function(b){var c=n.detectBrowser(b);if("object"===
("undefined"===typeof b?"undefined":a(b))&&(b.RTCPeerConnection||b.mozRTCPeerConnection)){!b.RTCPeerConnection&&b.mozRTCPeerConnection&&(b.RTCPeerConnection=b.mozRTCPeerConnection);53>c.version&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(a){var c=b.RTCPeerConnection.prototype[a],g=e({},a,function(){arguments[0]=new ("addIceCandidate"===a?b.RTCIceCandidate:b.RTCSessionDescription)(arguments[0]);return c.apply(this,arguments)});b.RTCPeerConnection.prototype[a]=
g[a]});if(68>c.version){var k=b.RTCPeerConnection.prototype.addIceCandidate;b.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?arguments[0]&&""===arguments[0].candidate?Promise.resolve():k.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}}var d={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},f=b.RTCPeerConnection.prototype.getStats;b.RTCPeerConnection.prototype.getStats=
function(){var a=Array.prototype.slice.call(arguments),b=a[1],g=a[2];return f.apply(this,[a[0]||null]).then(function(a){if(53>c.version&&!b)try{a.forEach(function(a){a.type=d[a.type]||a.type})}catch(q){if("TypeError"!==q.name)throw q;a.forEach(function(b,c){a.set(c,Object.assign({},b,{type:d[b.type]||b.type}))})}return a}).then(b,g)}}};h.shimSenderGetStats=function(b){if("object"===("undefined"===typeof b?"undefined":a(b))&&b.RTCPeerConnection&&b.RTCRtpSender&&!(b.RTCRtpSender&&"getStats"in b.RTCRtpSender.prototype)){var c=
b.RTCPeerConnection.prototype.getSenders;c&&(b.RTCPeerConnection.prototype.getSenders=function(){var a=this,b=c.apply(this,[]);b.forEach(function(b){return b._pc=a});return b});var k=b.RTCPeerConnection.prototype.addTrack;k&&(b.RTCPeerConnection.prototype.addTrack=function(){var a=k.apply(this,arguments);a._pc=this;return a});b.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}};h.shimReceiverGetStats=function(b){if("object"===("undefined"===
typeof b?"undefined":a(b))&&b.RTCPeerConnection&&b.RTCRtpSender&&!(b.RTCRtpSender&&"getStats"in b.RTCRtpReceiver.prototype)){var c=b.RTCPeerConnection.prototype.getReceivers;c&&(b.RTCPeerConnection.prototype.getReceivers=function(){var a=this,b=c.apply(this,[]);b.forEach(function(b){return b._pc=a});return b});n.wrapPeerConnectionEvent(b,"track",function(a){a.receiver._pc=a.srcElement;return a});b.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}};h.shimRemoveStream=
function(a){!a.RTCPeerConnection||"removeStream"in a.RTCPeerConnection.prototype||(a.RTCPeerConnection.prototype.removeStream=function(a){var b=this;n.deprecated("removeStream","removeTrack");this.getSenders().forEach(function(c){c.track&&a.getTracks().includes(c.track)&&b.removeTrack(c)})})};h.shimRTCDataChannel=function(a){a.DataChannel&&!a.RTCDataChannel&&(a.RTCDataChannel=a.DataChannel)};h.shimAddTransceiver=function(b){if("object"===("undefined"===typeof b?"undefined":a(b))&&b.RTCPeerConnection){var c=
b.RTCPeerConnection.prototype.addTransceiver;c&&(b.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];var a=arguments[1],b=a&&"sendEncodings"in a;b&&a.sendEncodings.forEach(function(a){if("rid"in a&&!/^[a-z0-9]{0,16}$/i.test(a.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in a&&!(1<=parseFloat(a.scaleResolutionDownBy)))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in a&&!(0<=parseFloat(a.maxFramerate)))throw new RangeError("max_framerate must be >= 0.0");
});var g=c.apply(this,arguments);if(b){var d=g.sender;b=d.getParameters();"encodings"in b||(b.encodings=a.sendEncodings,d.sendEncodings=a.sendEncodings,this.setParametersPromises.push(d.setParameters(b).then(function(){delete d.sendEncodings}).catch(function(){delete d.sendEncodings})))}return g})}};h.shimGetParameters=function(b){if("object"===("undefined"===typeof b?"undefined":a(b))&&b.RTCRtpSender){var c=b.RTCRtpSender.prototype.getParameters;c&&(b.RTCRtpSender.prototype.getParameters=function(){var a=
c.apply(this,arguments);return"sendEncodings"in this?Object.assign({},{encodings:this.sendEncodings},a):a})}};h.shimCreateOffer=function(b){if("object"===("undefined"===typeof b?"undefined":a(b))&&b.RTCPeerConnection){var c=b.RTCPeerConnection.prototype.createOffer;b.RTCPeerConnection.prototype.createOffer=function(){var a=this,b=arguments;return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(function(){return c.apply(a,b)}).finally(function(){a.setParametersPromises=
[]}):c.apply(this,arguments)}}};h.shimCreateAnswer=function(b){if("object"===("undefined"===typeof b?"undefined":a(b))&&b.RTCPeerConnection){var c=b.RTCPeerConnection.prototype.createAnswer;b.RTCPeerConnection.prototype.createAnswer=function(){var a=this,b=arguments;return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(function(){return c.apply(a,b)}).finally(function(){a.setParametersPromises=[]}):c.apply(this,arguments)}}};var n=function(a){if(a&&
a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);b.default=a;return b}(f("../utils"))},{"../utils":15,"./getdisplaymedia":12,"./getusermedia":13}],12:[function(f,l,h){Object.defineProperty(h,"__esModule",{value:!0});h.shimGetDisplayMedia=function(e,a){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||!e.navigator.mediaDevices||(e.navigator.mediaDevices.getDisplayMedia=function(d){if(!d||!d.video)return d=new DOMException("getDisplayMedia without video constraints is undefined"),
d.name="NotFoundError",d.code=8,Promise.reject(d);!0===d.video?d.video={mediaSource:a}:d.video.mediaSource=a;return e.navigator.mediaDevices.getUserMedia(d)})}},{}],13:[function(f,l,h){Object.defineProperty(h,"__esModule",{value:!0});var e="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};h.shimGetUserMedia=function(d){var c=a.detectBrowser(d),
f=d&&d.navigator;d=d&&d.MediaStreamTrack;f.getUserMedia=function(b,c,g){a.deprecated("navigator.getUserMedia","navigator.mediaDevices.getUserMedia");f.mediaDevices.getUserMedia(b).then(c,g)};if(!(55<c.version&&"autoGainControl"in f.mediaDevices.getSupportedConstraints())){var b=function(a,b,c){b in a&&!(c in a)&&(a[c]=a[b],delete a[b])},g=f.mediaDevices.getUserMedia.bind(f.mediaDevices);f.mediaDevices.getUserMedia=function(a){"object"===("undefined"===typeof a?"undefined":e(a))&&"object"===e(a.audio)&&
(a=JSON.parse(JSON.stringify(a)),b(a.audio,"autoGainControl","mozAutoGainControl"),b(a.audio,"noiseSuppression","mozNoiseSuppression"));return g(a)};if(d&&d.prototype.getSettings){var k=d.prototype.getSettings;d.prototype.getSettings=function(){var a=k.apply(this,arguments);b(a,"mozAutoGainControl","autoGainControl");b(a,"mozNoiseSuppression","noiseSuppression");return a}}if(d&&d.prototype.applyConstraints){var h=d.prototype.applyConstraints;d.prototype.applyConstraints=function(a){"audio"===this.kind&&
"object"===("undefined"===typeof a?"undefined":e(a))&&(a=JSON.parse(JSON.stringify(a)),b(a,"autoGainControl","mozAutoGainControl"),b(a,"noiseSuppression","mozNoiseSuppression"));return h.apply(this,[a])}}}};var a=function(a){if(a&&a.__esModule)return a;var c={};if(null!=a)for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&(c[d]=a[d]);c.default=a;return c}(f("../utils"))},{"../utils":15}],14:[function(f,l,h){function e(a){return a&&void 0!==a.video?Object.assign({},a,{video:d.compactObject(a.video)}):
a}Object.defineProperty(h,"__esModule",{value:!0});var a="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};h.shimLocalStreamsAPI=function(c){if("object"===("undefined"===typeof c?"undefined":a(c))&&c.RTCPeerConnection){"getLocalStreams"in c.RTCPeerConnection.prototype||(c.RTCPeerConnection.prototype.getLocalStreams=function(){this._localStreams||
(this._localStreams=[]);return this._localStreams});if(!("addStream"in c.RTCPeerConnection.prototype)){var d=c.RTCPeerConnection.prototype.addTrack;c.RTCPeerConnection.prototype.addStream=function(a){var b=this;this._localStreams||(this._localStreams=[]);this._localStreams.includes(a)||this._localStreams.push(a);a.getAudioTracks().forEach(function(c){return d.call(b,c,a)});a.getVideoTracks().forEach(function(c){return d.call(b,c,a)})};c.RTCPeerConnection.prototype.addTrack=function(a){for(var b=this,
c=arguments.length,e=Array(1<c?c-1:0),f=1;f<c;f++)e[f-1]=arguments[f];e&&e.forEach(function(a){b._localStreams?b._localStreams.includes(a)||b._localStreams.push(a):b._localStreams=[a]});return d.apply(this,arguments)}}"removeStream"in c.RTCPeerConnection.prototype||(c.RTCPeerConnection.prototype.removeStream=function(a){var b=this;this._localStreams||(this._localStreams=[]);var c=this._localStreams.indexOf(a);if(-1!==c){this._localStreams.splice(c,1);var d=a.getTracks();this.getSenders().forEach(function(a){d.includes(a.track)&&
b.removeTrack(a)})}})}};h.shimRemoteStreamsAPI=function(c){if("object"===("undefined"===typeof c?"undefined":a(c))&&c.RTCPeerConnection&&("getRemoteStreams"in c.RTCPeerConnection.prototype||(c.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in c.RTCPeerConnection.prototype))){Object.defineProperty(c.RTCPeerConnection.prototype,"onaddstream",{get:function(){return this._onaddstream},set:function(a){var b=this;this._onaddstream&&
(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly));this.addEventListener("addstream",this._onaddstream=a);this.addEventListener("track",this._onaddstreampoly=function(a){a.streams.forEach(function(a){b._remoteStreams||(b._remoteStreams=[]);if(!b._remoteStreams.includes(a)){b._remoteStreams.push(a);var c=new Event("addstream");c.stream=a;b.dispatchEvent(c)}})})}});var d=c.RTCPeerConnection.prototype.setRemoteDescription;c.RTCPeerConnection.prototype.setRemoteDescription=
function(){var a=this;this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(b){b.streams.forEach(function(b){a._remoteStreams||(a._remoteStreams=[]);if(!(0<=a._remoteStreams.indexOf(b))){a._remoteStreams.push(b);var c=new Event("addstream");c.stream=b;a.dispatchEvent(c)}})});return d.apply(a,arguments)}}};h.shimCallbacksAPI=function(c){if("object"===("undefined"===typeof c?"undefined":a(c))&&c.RTCPeerConnection){c=c.RTCPeerConnection.prototype;var d=c.createOffer,b=c.createAnswer,
g=c.setLocalDescription,k=c.setRemoteDescription,e=c.addIceCandidate;c.createOffer=function(a,b){var c=d.apply(this,[2<=arguments.length?arguments[2]:arguments[0]]);if(!b)return c;c.then(a,b);return Promise.resolve()};c.createAnswer=function(a,c){var d=b.apply(this,[2<=arguments.length?arguments[2]:arguments[0]]);if(!c)return d;d.then(a,c);return Promise.resolve()};var f=function(a,b,c){a=g.apply(this,[a]);if(!c)return a;a.then(b,c);return Promise.resolve()};c.setLocalDescription=f;f=function(a,b,
c){a=k.apply(this,[a]);if(!c)return a;a.then(b,c);return Promise.resolve()};c.setRemoteDescription=f;f=function(a,b,c){a=e.apply(this,[a]);if(!c)return a;a.then(b,c);return Promise.resolve()};c.addIceCandidate=f}};h.shimGetUserMedia=function(a){var c=a&&a.navigator;if(c.mediaDevices&&c.mediaDevices.getUserMedia){a=c.mediaDevices;var b=a.getUserMedia.bind(a);c.mediaDevices.getUserMedia=function(a){return b(e(a))}}!c.getUserMedia&&c.mediaDevices&&c.mediaDevices.getUserMedia&&(c.getUserMedia=function(a,
b,d){c.mediaDevices.getUserMedia(a).then(b,d)}.bind(c))};h.shimConstraints=e;h.shimRTCIceServerUrls=function(a){if(a.RTCPeerConnection){var c=a.RTCPeerConnection;a.RTCPeerConnection=function(a,g){if(a&&a.iceServers){for(var b=[],e=0;e<a.iceServers.length;e++){var f=a.iceServers[e];!f.hasOwnProperty("urls")&&f.hasOwnProperty("url")?(d.deprecated("RTCIceServer.url","RTCIceServer.urls"),f=JSON.parse(JSON.stringify(f)),f.urls=f.url,delete f.url,b.push(f)):b.push(a.iceServers[e])}a.iceServers=b}return new c(a,
g)};a.RTCPeerConnection.prototype=c.prototype;"generateCertificate"in c&&Object.defineProperty(a.RTCPeerConnection,"generateCertificate",{get:function(){return c.generateCertificate}})}};h.shimTrackEventTransceiver=function(c){"object"===("undefined"===typeof c?"undefined":a(c))&&c.RTCTrackEvent&&"receiver"in c.RTCTrackEvent.prototype&&!("transceiver"in c.RTCTrackEvent.prototype)&&Object.defineProperty(c.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})};h.shimCreateOfferLegacy=
function(a){var c=a.RTCPeerConnection.prototype.createOffer;a.RTCPeerConnection.prototype.createOffer=function(a){if(a){"undefined"!==typeof a.offerToReceiveAudio&&(a.offerToReceiveAudio=!!a.offerToReceiveAudio);var b=this.getTransceivers().find(function(a){return"audio"===a.receiver.track.kind});!1===a.offerToReceiveAudio&&b?"sendrecv"===b.direction?b.setDirection?b.setDirection("sendonly"):b.direction="sendonly":"recvonly"===b.direction&&(b.setDirection?b.setDirection("inactive"):b.direction="inactive"):
!0!==a.offerToReceiveAudio||b||this.addTransceiver("audio");"undefined"!==typeof a.offerToReceiveVideo&&(a.offerToReceiveVideo=!!a.offerToReceiveVideo);b=this.getTransceivers().find(function(a){return"video"===a.receiver.track.kind});!1===a.offerToReceiveVideo&&b?"sendrecv"===b.direction?b.setDirection?b.setDirection("sendonly"):b.direction="sendonly":"recvonly"===b.direction&&(b.setDirection?b.setDirection("inactive"):b.direction="inactive"):!0!==a.offerToReceiveVideo||b||this.addTransceiver("video")}return c.apply(this,
arguments)}};h.shimAudioContext=function(c){"object"!==("undefined"===typeof c?"undefined":a(c))||c.AudioContext||(c.AudioContext=c.webkitAudioContext)};var d=function(a){if(a&&a.__esModule)return a;var c={};if(null!=a)for(var b in a)Object.prototype.hasOwnProperty.call(a,b)&&(c[b]=a[b]);c.default=a;return c}(f("../utils"))},{"../utils":15}],15:[function(f,l,h){function e(a,b,c){b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c;return a}function a(a,b,c){return(a=
a.match(b))&&a.length>=c&&parseInt(a[c],10)}function d(a){return"[object Object]"!==Object.prototype.toString.call(a)?a:Object.keys(a).reduce(function(b,c){var g="[object Object]"===Object.prototype.toString.call(a[c]),k=g?d(a[c]):a[c];g=g&&!Object.keys(k).length;return void 0===k||g?b:Object.assign(b,e({},c,k))},{})}function c(a,b,d){b&&!d.has(b.id)&&(d.set(b.id,b),Object.keys(b).forEach(function(g){g.endsWith("Id")?c(a,a.get(b[g]),d):g.endsWith("Ids")&&b[g].forEach(function(b){c(a,a.get(b),d)})}))}
Object.defineProperty(h,"__esModule",{value:!0});var n="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};h.extractVersion=a;h.wrapPeerConnectionEvent=function(a,b,c){if(a.RTCPeerConnection){a=a.RTCPeerConnection.prototype;var d=a.addEventListener;a.addEventListener=function(a,g){if(a!==b)return d.apply(this,arguments);var e=function(a){(a=c(a))&&
(g.handleEvent?g.handleEvent(a):g(a))};this._eventMap=this._eventMap||{};this._eventMap[b]||(this._eventMap[b]=new Map);this._eventMap[b].set(g,e);return d.apply(this,[a,e])};var g=a.removeEventListener;a.removeEventListener=function(a,c){if(a!==b||!this._eventMap||!this._eventMap[b]||!this._eventMap[b].has(c))return g.apply(this,arguments);var d=this._eventMap[b].get(c);this._eventMap[b].delete(c);0===this._eventMap[b].size&&delete this._eventMap[b];0===Object.keys(this._eventMap).length&&delete this._eventMap;
return g.apply(this,[a,d])};Object.defineProperty(a,"on"+b,{get:function(){return this["_on"+b]},set:function(a){this["_on"+b]&&(this.removeEventListener(b,this["_on"+b]),delete this["_on"+b]);a&&this.addEventListener(b,this["_on"+b]=a)},enumerable:!0,configurable:!0})}};h.disableLog=function(a){return"boolean"!==typeof a?Error("Argument type: "+("undefined"===typeof a?"undefined":n(a))+". Please use a boolean."):(b=a)?"adapter.js logging disabled":"adapter.js logging enabled"};h.disableWarnings=
function(a){if("boolean"!==typeof a)return Error("Argument type: "+("undefined"===typeof a?"undefined":n(a))+". Please use a boolean.");g=!a;return"adapter.js deprecation warnings "+(a?"disabled":"enabled")};h.log=function(){"object"!==("undefined"===typeof window?"undefined":n(window))||b||"undefined"!==typeof console&&"function"===typeof console.log&&console.log.apply(console,arguments)};h.deprecated=function(a,b){g&&console.warn(a+" is deprecated, please use "+b+" instead.")};h.detectBrowser=function(b){var c=
b.navigator,d={browser:null,version:null};if("undefined"===typeof b||!b.navigator)return d.browser="Not a browser.",d;c.mozGetUserMedia?(d.browser="firefox",d.version=a(c.userAgent,/Firefox\/(\d+)\./,1)):c.webkitGetUserMedia||!1===b.isSecureContext&&b.webkitRTCPeerConnection&&!b.RTCIceGatherer?(d.browser="chrome",d.version=a(c.userAgent,/Chrom(e|ium)\/(\d+)\./,2)):c.mediaDevices&&c.userAgent.match(/Edge\/(\d+).(\d+)$/)?(d.browser="edge",d.version=a(c.userAgent,/Edge\/(\d+).(\d+)$/,2)):b.RTCPeerConnection&&
c.userAgent.match(/AppleWebKit\/(\d+)\./)?(d.browser="safari",d.version=a(c.userAgent,/AppleWebKit\/(\d+)\./,1),d.supportsUnifiedPlan=b.RTCRtpTransceiver&&"currentDirection"in b.RTCRtpTransceiver.prototype):d.browser="Not a supported browser.";return d};h.compactObject=d;h.walkStats=c;h.filterStats=function(a,b,d){var g=d?"outbound-rtp":"inbound-rtp",e=new Map;if(null===b)return e;var f=[];a.forEach(function(a){"track"===a.type&&a.trackIdentifier===b.id&&f.push(a)});f.forEach(function(b){a.forEach(function(d){d.type===
g&&d.trackId===b.id&&c(a,d,e)})});return e};var b=!0,g=!0},{}],16:[function(f,l,h){function e(a,b,c,d,e){b=g.writeRtpDescription(a.kind,b);b+=g.writeIceParameters(a.iceGatherer.getLocalParameters());b+=g.writeDtlsParameters(a.dtlsTransport.getLocalParameters(),"offer"===c?"actpass":e||"active");b+="a=mid:"+a.mid+"\r\n";b=a.rtpSender&&a.rtpReceiver?b+"a=sendrecv\r\n":a.rtpSender?b+"a=sendonly\r\n":a.rtpReceiver?b+"a=recvonly\r\n":b+"a=inactive\r\n";a.rtpSender&&(c=a.rtpSender._initialTrackId||a.rtpSender.track.id,
a.rtpSender._initialTrackId=c,d="msid:"+(d?d.id:"-")+" "+c+"\r\n",b=b+("a="+d)+("a=ssrc:"+a.sendEncodingParameters[0].ssrc+" "+d),a.sendEncodingParameters[0].rtx&&(b+="a=ssrc:"+a.sendEncodingParameters[0].rtx.ssrc+" "+d,b+="a=ssrc-group:FID "+a.sendEncodingParameters[0].ssrc+" "+a.sendEncodingParameters[0].rtx.ssrc+"\r\n"));b+="a=ssrc:"+a.sendEncodingParameters[0].ssrc+" cname:"+g.localCName+"\r\n";a.rtpSender&&a.sendEncodingParameters[0].rtx&&(b+="a=ssrc:"+a.sendEncodingParameters[0].rtx.ssrc+" cname:"+
g.localCName+"\r\n");return b}function a(a,b){var c=!1;a=JSON.parse(JSON.stringify(a));return a.filter(function(a){if(a&&(a.urls||a.url)){var d=a.urls||a.url;a.url&&!a.urls&&console.warn("RTCIceServer.url is deprecated! Use urls instead.");var g="string"===typeof d;g&&(d=[d]);d=d.filter(function(a){return 0!==a.indexOf("turn:")||-1===a.indexOf("transport=udp")||-1!==a.indexOf("turn:[")||c?0===a.indexOf("stun:")&&14393<=b&&-1===a.indexOf("?transport=udp"):c=!0});delete a.url;a.urls=g?d[0]:d;return!!d.length}})}
function d(a,b){var c={codecs:[],headerExtensions:[],fecMechanisms:[]},d=function(a,b){a=parseInt(a,10);for(var c=0;c<b.length;c++)if(b[c].payloadType===a||b[c].preferredPayloadType===a)return b[c]},g=function(a,b,c,g){a=d(a.parameters.apt,c);b=d(b.parameters.apt,g);return a&&b&&a.name.toLowerCase()===b.name.toLowerCase()};a.codecs.forEach(function(d){for(var e=0;e<b.codecs.length;e++){var f=b.codecs[e];if(d.name.toLowerCase()===f.name.toLowerCase()&&d.clockRate===f.clockRate&&("rtx"!==d.name.toLowerCase()||
!d.parameters||!f.parameters.apt||g(d,f,a.codecs,b.codecs))){f=JSON.parse(JSON.stringify(f));f.numChannels=Math.min(d.numChannels,f.numChannels);c.codecs.push(f);f.rtcpFeedback=f.rtcpFeedback.filter(function(a){for(var b=0;b<d.rtcpFeedback.length;b++)if(d.rtcpFeedback[b].type===a.type&&d.rtcpFeedback[b].parameter===a.parameter)return!0;return!1});break}}});a.headerExtensions.forEach(function(a){for(var d=0;d<b.headerExtensions.length;d++){var g=b.headerExtensions[d];if(a.uri===g.uri){c.headerExtensions.push(g);
break}}});return c}function c(a,b,c){return-1!=={offer:{setLocalDescription:["stable","have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer","have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[b][a].indexOf(c)}function n(a,b){var c=a.getRemoteCandidates().find(function(a){return b.foundation===a.foundation&&b.ip===a.ip&&b.port===a.port&&b.priority===a.priority&&b.protocol===a.protocol&&b.type===
a.type});c||a.addRemoteCandidate(b);return!c}function b(a,b){b=Error(b);b.name=a;b.code={NotSupportedError:9,InvalidStateError:11,InvalidAccessError:15,TypeError:void 0,OperationError:void 0}[a];return b}var g=f("sdp");l.exports=function(f,h){function k(a,b){b.addTrack(a);b.dispatchEvent(new f.MediaStreamTrackEvent("addtrack",{track:a}))}function l(a,b){b.removeTrack(a);b.dispatchEvent(new f.MediaStreamTrackEvent("removetrack",{track:a}))}function E(a,b,c,d){var g=new Event("track");g.track=b;g.receiver=
c;g.transceiver={receiver:c};g.streams=d;f.setTimeout(function(){a._dispatchEvent("track",g)})}var m=function(c){var d=this,e=document.createDocumentFragment();["addEventListener","removeEventListener","dispatchEvent"].forEach(function(a){d[a]=e[a].bind(e)});this.canTrickleIceCandidates=null;this.needNegotiation=!1;this.localStreams=[];this.remoteStreams=[];this._remoteDescription=this._localDescription=null;this.signalingState="stable";this.iceGatheringState=this.connectionState=this.iceConnectionState=
"new";c=JSON.parse(JSON.stringify(c||{}));this.usingBundle="max-bundle"===c.bundlePolicy;if("negotiate"===c.rtcpMuxPolicy)throw b("NotSupportedError","rtcpMuxPolicy 'negotiate' is not supported");c.rtcpMuxPolicy||(c.rtcpMuxPolicy="require");switch(c.iceTransportPolicy){case "all":case "relay":break;default:c.iceTransportPolicy="all"}switch(c.bundlePolicy){case "balanced":case "max-compat":case "max-bundle":break;default:c.bundlePolicy="balanced"}c.iceServers=a(c.iceServers||[],h);this._iceGatherers=
[];if(c.iceCandidatePoolSize)for(var q=c.iceCandidatePoolSize;0<q;q--)this._iceGatherers.push(new f.RTCIceGatherer({iceServers:c.iceServers,gatherPolicy:c.iceTransportPolicy}));else c.iceCandidatePoolSize=0;this._config=c;this.transceivers=[];this._sdpSessionId=g.generateSessionId();this._sdpSessionVersion=0;this._dtlsRole=void 0;this._isClosed=!1};Object.defineProperty(m.prototype,"localDescription",{configurable:!0,get:function(){return this._localDescription}});Object.defineProperty(m.prototype,
"remoteDescription",{configurable:!0,get:function(){return this._remoteDescription}});m.prototype.onicecandidate=null;m.prototype.onaddstream=null;m.prototype.ontrack=null;m.prototype.onremovestream=null;m.prototype.onsignalingstatechange=null;m.prototype.oniceconnectionstatechange=null;m.prototype.onconnectionstatechange=null;m.prototype.onicegatheringstatechange=null;m.prototype.onnegotiationneeded=null;m.prototype.ondatachannel=null;m.prototype._dispatchEvent=function(a,b){if(!this._isClosed&&
(this.dispatchEvent(b),"function"===typeof this["on"+a]))this["on"+a](b)};m.prototype._emitGatheringStateChange=function(){var a=new Event("icegatheringstatechange");this._dispatchEvent("icegatheringstatechange",a)};m.prototype.getConfiguration=function(){return this._config};m.prototype.getLocalStreams=function(){return this.localStreams};m.prototype.getRemoteStreams=function(){return this.remoteStreams};m.prototype._createTransceiver=function(a,b){var c=0<this.transceivers.length;a={track:null,
iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:a,mid:null,sendEncodingParameters:null,recvEncodingParameters:null,stream:null,associatedRemoteMediaStreams:[],wantReceive:!0};this.usingBundle&&c?(a.iceTransport=this.transceivers[0].iceTransport,a.dtlsTransport=this.transceivers[0].dtlsTransport):(c=this._createIceAndDtlsTransports(),a.iceTransport=c.iceTransport,a.dtlsTransport=c.dtlsTransport);b||this.transceivers.push(a);
return a};m.prototype.addTrack=function(a,c){if(this._isClosed)throw b("InvalidStateError","Attempted to call addTrack on a closed peerconnection.");if(this.transceivers.find(function(b){return b.track===a}))throw b("InvalidAccessError","Track already exists.");for(var d,g=0;g<this.transceivers.length;g++)this.transceivers[g].track||this.transceivers[g].kind!==a.kind||(d=this.transceivers[g]);d||(d=this._createTransceiver(a.kind));this._maybeFireNegotiationNeeded();-1===this.localStreams.indexOf(c)&&
this.localStreams.push(c);d.track=a;d.stream=c;d.rtpSender=new f.RTCRtpSender(a,d.dtlsTransport);return d.rtpSender};m.prototype.addStream=function(a){var b=this;if(15025<=h)a.getTracks().forEach(function(c){b.addTrack(c,a)});else{var c=a.clone();a.getTracks().forEach(function(a,b){var d=c.getTracks()[b];a.addEventListener("enabled",function(a){d.enabled=a.enabled})});c.getTracks().forEach(function(a){b.addTrack(a,c)})}};m.prototype.removeTrack=function(a){if(this._isClosed)throw b("InvalidStateError",
"Attempted to call removeTrack on a closed peerconnection.");if(!(a instanceof f.RTCRtpSender))throw new TypeError("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.");var c=this.transceivers.find(function(b){return b.rtpSender===a});if(!c)throw b("InvalidAccessError","Sender was not created by this connection.");var d=c.stream;c.rtpSender.stop();c.rtpSender=null;c.track=null;c.stream=null;-1===this.transceivers.map(function(a){return a.stream}).indexOf(d)&&-1<
this.localStreams.indexOf(d)&&this.localStreams.splice(this.localStreams.indexOf(d),1);this._maybeFireNegotiationNeeded()};m.prototype.removeStream=function(a){var b=this;a.getTracks().forEach(function(a){var c=b.getSenders().find(function(b){return b.track===a});c&&b.removeTrack(c)})};m.prototype.getSenders=function(){return this.transceivers.filter(function(a){return!!a.rtpSender}).map(function(a){return a.rtpSender})};m.prototype.getReceivers=function(){return this.transceivers.filter(function(a){return!!a.rtpReceiver}).map(function(a){return a.rtpReceiver})};
m.prototype._createIceGatherer=function(a,b){var c=this;if(b&&0<a)return this.transceivers[0].iceGatherer;if(this._iceGatherers.length)return this._iceGatherers.shift();var d=new f.RTCIceGatherer({iceServers:this._config.iceServers,gatherPolicy:this._config.iceTransportPolicy});Object.defineProperty(d,"state",{value:"new",writable:!0});this.transceivers[a].bufferedCandidateEvents=[];this.transceivers[a].bufferCandidates=function(b){var g=!b.candidate||0===Object.keys(b.candidate).length;d.state=g?
"completed":"gathering";null!==c.transceivers[a].bufferedCandidateEvents&&c.transceivers[a].bufferedCandidateEvents.push(b)};d.addEventListener("localcandidate",this.transceivers[a].bufferCandidates);return d};m.prototype._gather=function(a,b){var c=this,d=this.transceivers[b].iceGatherer;if(!d.onlocalcandidate){var e=this.transceivers[b].bufferedCandidateEvents;this.transceivers[b].bufferedCandidateEvents=null;d.removeEventListener("localcandidate",this.transceivers[b].bufferCandidates);d.onlocalcandidate=
function(f){if(!(c.usingBundle&&0<b)){var e=new Event("icecandidate");e.candidate={sdpMid:a,sdpMLineIndex:b};var h=f.candidate;if(f=!h||0===Object.keys(h).length){if("new"===d.state||"gathering"===d.state)d.state="completed"}else"new"===d.state&&(d.state="gathering"),h.component=1,h.ufrag=d.getLocalParameters().usernameFragment,h=g.writeCandidate(h),e.candidate=Object.assign(e.candidate,g.parseCandidate(h)),e.candidate.candidate=h,e.candidate.toJSON=function(){return{candidate:e.candidate.candidate,
sdpMid:e.candidate.sdpMid,sdpMLineIndex:e.candidate.sdpMLineIndex,usernameFragment:e.candidate.usernameFragment}};h=g.getMediaSections(c._localDescription.sdp);h[e.candidate.sdpMLineIndex]=f?h[e.candidate.sdpMLineIndex]+"a=end-of-candidates\r\n":h[e.candidate.sdpMLineIndex]+("a="+e.candidate.candidate+"\r\n");c._localDescription.sdp=g.getDescription(c._localDescription.sdp)+h.join("");h=c.transceivers.every(function(a){return a.iceGatherer&&"completed"===a.iceGatherer.state});"gathering"!==c.iceGatheringState&&
(c.iceGatheringState="gathering",c._emitGatheringStateChange());f||c._dispatchEvent("icecandidate",e);h&&(c._dispatchEvent("icecandidate",new Event("icecandidate")),c.iceGatheringState="complete",c._emitGatheringStateChange())}};f.setTimeout(function(){e.forEach(function(a){d.onlocalcandidate(a)})},0)}};m.prototype._createIceAndDtlsTransports=function(){var a=this,b=new f.RTCIceTransport(null);b.onicestatechange=function(){a._updateIceConnectionState();a._updateConnectionState()};var c=new f.RTCDtlsTransport(b);
c.ondtlsstatechange=function(){a._updateConnectionState()};c.onerror=function(){Object.defineProperty(c,"state",{value:"failed",writable:!0});a._updateConnectionState()};return{iceTransport:b,dtlsTransport:c}};m.prototype._disposeIceAndDtlsTransports=function(a){var b=this.transceivers[a].iceGatherer;b&&(delete b.onlocalcandidate,delete this.transceivers[a].iceGatherer);if(b=this.transceivers[a].iceTransport)delete b.onicestatechange,delete this.transceivers[a].iceTransport;if(b=this.transceivers[a].dtlsTransport)delete b.ondtlsstatechange,
delete b.onerror,delete this.transceivers[a].dtlsTransport};m.prototype._transceive=function(a,b,c){var f=d(a.localCapabilities,a.remoteCapabilities);b&&a.rtpSender&&(f.encodings=a.sendEncodingParameters,f.rtcp={cname:g.localCName,compound:a.rtcpParameters.compound},a.recvEncodingParameters.length&&(f.rtcp.ssrc=a.recvEncodingParameters[0].ssrc),a.rtpSender.send(f));c&&a.rtpReceiver&&0<f.codecs.length&&("video"===a.kind&&a.recvEncodingParameters&&15019>h&&a.recvEncodingParameters.forEach(function(a){delete a.rtx}),
f.encodings=a.recvEncodingParameters.length?a.recvEncodingParameters:[{}],f.rtcp={compound:a.rtcpParameters.compound},a.rtcpParameters.cname&&(f.rtcp.cname=a.rtcpParameters.cname),a.sendEncodingParameters.length&&(f.rtcp.ssrc=a.sendEncodingParameters[0].ssrc),a.rtpReceiver.receive(f))};m.prototype.setLocalDescription=function(a){var f=this;if(-1===["offer","answer"].indexOf(a.type))return Promise.reject(b("TypeError",'Unsupported type "'+a.type+'"'));if(!c("setLocalDescription",a.type,f.signalingState)||
f._isClosed)return Promise.reject(b("InvalidStateError","Can not set local "+a.type+" in state "+f.signalingState));if("offer"===a.type){var e=g.splitSections(a.sdp);var h=e.shift();e.forEach(function(a,b){a=g.parseRtpParameters(a);f.transceivers[b].localCapabilities=a});f.transceivers.forEach(function(a,b){f._gather(a.mid,b)})}else if("answer"===a.type){e=g.splitSections(f._remoteDescription.sdp);h=e.shift();var k=0<g.matchPrefix(h,"a=ice-lite").length;e.forEach(function(a,b){var c=f.transceivers[b],
e=c.iceGatherer,r=c.iceTransport,q=c.dtlsTransport,l=c.localCapabilities,n=c.remoteCapabilities;if(!(g.isRejected(a)&&0===g.matchPrefix(a,"a=bundle-only").length||c.rejected)){var x=g.getIceParameters(a,h);a=g.getDtlsParameters(a,h);k&&(a.role="server");f.usingBundle&&0!==b||(f._gather(c.mid,b),"new"===r.state&&r.start(e,x,k?"controlling":"controlled"),"new"===q.state&&q.start(a));b=d(l,n);f._transceive(c,0<b.codecs.length,!1)}})}f._localDescription={type:a.type,sdp:a.sdp};"offer"===a.type?f._updateSignalingState("have-local-offer"):
f._updateSignalingState("stable");return Promise.resolve()};m.prototype.setRemoteDescription=function(a){var e=this;if(-1===["offer","answer"].indexOf(a.type))return Promise.reject(b("TypeError",'Unsupported type "'+a.type+'"'));if(!c("setRemoteDescription",a.type,e.signalingState)||e._isClosed)return Promise.reject(b("InvalidStateError","Can not set remote "+a.type+" in state "+e.signalingState));var q={};e.remoteStreams.forEach(function(a){q[a.id]=a});var m=[],u=g.splitSections(a.sdp),A=u.shift(),
I=0<g.matchPrefix(A,"a=ice-lite").length,w=0<g.matchPrefix(A,"a=group:BUNDLE ").length;e.usingBundle=w;var t=g.matchPrefix(A,"a=ice-options:")[0];e.canTrickleIceCandidates=t?0<=t.substr(14).split(" ").indexOf("trickle"):!1;u.forEach(function(b,c){var r=g.splitLines(b),u=g.getKind(b),x=g.isRejected(b)&&0===g.matchPrefix(b,"a=bundle-only").length,C=r[0].substr(2).split(" ")[2];r=g.getDirection(b,A);var v=g.parseMsid(b),G=g.getMid(b)||g.generateIdentifier();if(x||"application"===u&&("DTLS/SCTP"===C||
"UDP/DTLS/SCTP"===C))e.transceivers[c]={mid:G,kind:u,protocol:C,rejected:!0};else{!x&&e.transceivers[c]&&e.transceivers[c].rejected&&(e.transceivers[c]=e._createTransceiver(u,!0));var t=g.parseRtpParameters(b);if(!x){var F=g.getIceParameters(b,A);var E=g.getDtlsParameters(b,A);E.role="client"}C=g.parseRtpEncodingParameters(b);var y=g.parseRtcpParameters(b),H=0<g.matchPrefix(b,"a=end-of-candidates",A).length,D=g.matchPrefix(b,"a=candidate:").map(function(a){return g.parseCandidate(a)}).filter(function(a){return 1===
a.component});("offer"===a.type||"answer"===a.type)&&!x&&w&&0<c&&e.transceivers[c]&&(e._disposeIceAndDtlsTransports(c),e.transceivers[c].iceGatherer=e.transceivers[0].iceGatherer,e.transceivers[c].iceTransport=e.transceivers[0].iceTransport,e.transceivers[c].dtlsTransport=e.transceivers[0].dtlsTransport,e.transceivers[c].rtpSender&&e.transceivers[c].rtpSender.setTransport(e.transceivers[0].dtlsTransport),e.transceivers[c].rtpReceiver&&e.transceivers[c].rtpReceiver.setTransport(e.transceivers[0].dtlsTransport));
if("offer"!==a.type||x)"answer"!==a.type||x||(p=e.transceivers[c],B=p.iceGatherer,u=p.iceTransport,G=p.dtlsTransport,z=p.rtpReceiver,x=p.sendEncodingParameters,b=p.localCapabilities,e.transceivers[c].recvEncodingParameters=C,e.transceivers[c].remoteCapabilities=t,e.transceivers[c].rtcpParameters=y,D.length&&"new"===u.state&&(!I&&!H||w&&0!==c?D.forEach(function(a){n(p.iceTransport,a)}):u.setRemoteCandidates(D)),w&&0!==c||("new"===u.state&&u.start(B,F,"controlling"),"new"===G.state&&G.start(E)),!d(p.localCapabilities,
p.remoteCapabilities).codecs.filter(function(a){return"rtx"===a.name.toLowerCase()}).length&&p.sendEncodingParameters[0].rtx&&delete p.sendEncodingParameters[0].rtx,e._transceive(p,"sendrecv"===r||"recvonly"===r,"sendrecv"===r||"sendonly"===r),!z||"sendrecv"!==r&&"sendonly"!==r?delete p.rtpReceiver:(r=z.track,v?(q[v.stream]||(q[v.stream]=new f.MediaStream),k(r,q[v.stream]),m.push([r,z,q[v.stream]])):(q.default||(q.default=new f.MediaStream),k(r,q.default),m.push([r,z,q.default]))));else{var p=e.transceivers[c]||
e._createTransceiver(u);p.mid=G;p.iceGatherer||(p.iceGatherer=e._createIceGatherer(c,w));D.length&&"new"===p.iceTransport.state&&(!H||w&&0!==c?D.forEach(function(a){n(p.iceTransport,a)}):p.iceTransport.setRemoteCandidates(D));b=f.RTCRtpReceiver.getCapabilities(u);15019>h&&(b.codecs=b.codecs.filter(function(a){return"rtx"!==a.name}));x=p.sendEncodingParameters||[{ssrc:1001*(2*c+2)}];F=!1;if("sendrecv"===r||"sendonly"===r){F=!p.rtpReceiver;var z=p.rtpReceiver||new f.RTCRtpReceiver(p.dtlsTransport,u);
if(F){r=z.track;if(!v||"-"!==v.stream)if(v){q[v.stream]||(q[v.stream]=new f.MediaStream,Object.defineProperty(q[v.stream],"id",{get:function(){return v.stream}}));Object.defineProperty(r,"id",{get:function(){return v.track}});var B=q[v.stream]}else q.default||(q.default=new f.MediaStream),B=q.default;B&&(k(r,B),p.associatedRemoteMediaStreams.push(B));m.push([r,z,B])}}else p.rtpReceiver&&p.rtpReceiver.track&&(p.associatedRemoteMediaStreams.forEach(function(a){var b=a.getTracks().find(function(a){return a.id===
p.rtpReceiver.track.id});b&&l(b,a)}),p.associatedRemoteMediaStreams=[]);p.localCapabilities=b;p.remoteCapabilities=t;p.rtpReceiver=z;p.rtcpParameters=y;p.sendEncodingParameters=x;p.recvEncodingParameters=C;e._transceive(e.transceivers[c],!1,F)}}});void 0===e._dtlsRole&&(e._dtlsRole="offer"===a.type?"active":"passive");e._remoteDescription={type:a.type,sdp:a.sdp};"offer"===a.type?e._updateSignalingState("have-remote-offer"):e._updateSignalingState("stable");Object.keys(q).forEach(function(a){var b=
q[a];if(b.getTracks().length){if(-1===e.remoteStreams.indexOf(b)){e.remoteStreams.push(b);var c=new Event("addstream");c.stream=b;f.setTimeout(function(){e._dispatchEvent("addstream",c)})}m.forEach(function(a){b.id===a[2].id&&E(e,a[0],a[1],[b])})}});m.forEach(function(a){a[2]||E(e,a[0],a[1],[])});f.setTimeout(function(){e&&e.transceivers&&e.transceivers.forEach(function(a){a.iceTransport&&"new"===a.iceTransport.state&&0<a.iceTransport.getRemoteCandidates().length&&(console.warn("Timeout for addRemoteCandidate. Consider sending an end-of-candidates notification"),
a.iceTransport.addRemoteCandidate({}))})},4E3);return Promise.resolve()};m.prototype.close=function(){this.transceivers.forEach(function(a){a.iceTransport&&a.iceTransport.stop();a.dtlsTransport&&a.dtlsTransport.stop();a.rtpSender&&a.rtpSender.stop();a.rtpReceiver&&a.rtpReceiver.stop()});this._isClosed=!0;this._updateSignalingState("closed")};m.prototype._updateSignalingState=function(a){this.signalingState=a;a=new Event("signalingstatechange");this._dispatchEvent("signalingstatechange",a)};m.prototype._maybeFireNegotiationNeeded=
function(){var a=this;"stable"===this.signalingState&&!0!==this.needNegotiation&&(this.needNegotiation=!0,f.setTimeout(function(){if(a.needNegotiation){a.needNegotiation=!1;var b=new Event("negotiationneeded");a._dispatchEvent("negotiationneeded",b)}},0))};m.prototype._updateIceConnectionState=function(){var a={"new":0,closed:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};this.transceivers.forEach(function(b){b.iceTransport&&!b.rejected&&a[b.iceTransport.state]++});var b="new";0<a.failed?
b="failed":0<a.checking?b="checking":0<a.disconnected?b="disconnected":0<a.new?b="new":0<a.connected?b="connected":0<a.completed&&(b="completed");b!==this.iceConnectionState&&(this.iceConnectionState=b,b=new Event("iceconnectionstatechange"),this._dispatchEvent("iceconnectionstatechange",b))};m.prototype._updateConnectionState=function(){var a={"new":0,closed:0,connecting:0,connected:0,completed:0,disconnected:0,failed:0};this.transceivers.forEach(function(b){b.iceTransport&&b.dtlsTransport&&!b.rejected&&
(a[b.iceTransport.state]++,a[b.dtlsTransport.state]++)});a.connected+=a.completed;var b="new";0<a.failed?b="failed":0<a.connecting?b="connecting":0<a.disconnected?b="disconnected":0<a.new?b="new":0<a.connected&&(b="connected");b!==this.connectionState&&(this.connectionState=b,b=new Event("connectionstatechange"),this._dispatchEvent("connectionstatechange",b))};m.prototype.createOffer=function(a){var c=this;if(c._isClosed)return Promise.reject(b("InvalidStateError","Can not call createOffer after close"));
var d=c.transceivers.filter(function(a){return"audio"===a.kind}).length,k=c.transceivers.filter(function(a){return"video"===a.kind}).length;if(a){if(a.mandatory||a.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");void 0!==a.offerToReceiveAudio&&(d=!0===a.offerToReceiveAudio?1:!1===a.offerToReceiveAudio?0:a.offerToReceiveAudio);void 0!==a.offerToReceiveVideo&&(k=!0===a.offerToReceiveVideo?1:!1===a.offerToReceiveVideo?0:a.offerToReceiveVideo)}for(c.transceivers.forEach(function(a){"audio"===
a.kind?(d--,0>d&&(a.wantReceive=!1)):"video"===a.kind&&(k--,0>k&&(a.wantReceive=!1))});0<d||0<k;)0<d&&(c._createTransceiver("audio"),d--),0<k&&(c._createTransceiver("video"),k--);var l=g.writeSessionBoilerplate(c._sdpSessionId,c._sdpSessionVersion++);c.transceivers.forEach(function(a,b){var d=a.track,e=a.kind,k=a.mid||g.generateIdentifier();a.mid=k;a.iceGatherer||(a.iceGatherer=c._createIceGatherer(b,c.usingBundle));k=f.RTCRtpSender.getCapabilities(e);15019>h&&(k.codecs=k.codecs.filter(function(a){return"rtx"!==
a.name}));k.codecs.forEach(function(b){"H264"===b.name&&void 0===b.parameters["level-asymmetry-allowed"]&&(b.parameters["level-asymmetry-allowed"]="1");a.remoteCapabilities&&a.remoteCapabilities.codecs&&a.remoteCapabilities.codecs.forEach(function(a){b.name.toLowerCase()===a.name.toLowerCase()&&b.clockRate===a.clockRate&&(b.preferredPayloadType=a.payloadType)})});k.headerExtensions.forEach(function(b){(a.remoteCapabilities&&a.remoteCapabilities.headerExtensions||[]).forEach(function(a){b.uri===a.uri&&
(b.id=a.id)})});b=a.sendEncodingParameters||[{ssrc:1001*(2*b+1)}];d&&15019<=h&&"video"===e&&!b[0].rtx&&(b[0].rtx={ssrc:b[0].ssrc+1});a.wantReceive&&(a.rtpReceiver=new f.RTCRtpReceiver(a.dtlsTransport,e));a.localCapabilities=k;a.sendEncodingParameters=b});"max-compat"!==c._config.bundlePolicy&&(l+="a=group:BUNDLE "+c.transceivers.map(function(a){return a.mid}).join(" ")+"\r\n");l+="a=ice-options:trickle\r\n";c.transceivers.forEach(function(a,b){l+=e(a,a.localCapabilities,"offer",a.stream,c._dtlsRole);
l+="a=rtcp-rsize\r\n";!a.iceGatherer||"new"===c.iceGatheringState||0!==b&&c.usingBundle||(a.iceGatherer.getLocalCandidates().forEach(function(a){a.component=1;l+="a="+g.writeCandidate(a)+"\r\n"}),"completed"===a.iceGatherer.state&&(l+="a=end-of-candidates\r\n"))});a=new f.RTCSessionDescription({type:"offer",sdp:l});return Promise.resolve(a)};m.prototype.createAnswer=function(){var a=this;if(a._isClosed)return Promise.reject(b("InvalidStateError","Can not call createAnswer after close"));if("have-remote-offer"!==
a.signalingState&&"have-local-pranswer"!==a.signalingState)return Promise.reject(b("InvalidStateError","Can not call createAnswer in signalingState "+a.signalingState));var c=g.writeSessionBoilerplate(a._sdpSessionId,a._sdpSessionVersion++);a.usingBundle&&(c+="a=group:BUNDLE "+a.transceivers.map(function(a){return a.mid}).join(" ")+"\r\n");c+="a=ice-options:trickle\r\n";var k=g.getMediaSections(a._remoteDescription.sdp).length;a.transceivers.forEach(function(b,f){if(!(f+1>k))if(b.rejected)"application"===
b.kind?c="DTLS/SCTP"===b.protocol?c+"m=application 0 DTLS/SCTP 5000\r\n":c+("m=application 0 "+b.protocol+" webrtc-datachannel\r\n"):"audio"===b.kind?c+="m=audio 0 UDP/TLS/RTP/SAVPF 0\r\na=rtpmap:0 PCMU/8000\r\n":"video"===b.kind&&(c+="m=video 0 UDP/TLS/RTP/SAVPF 120\r\na=rtpmap:120 VP8/90000\r\n"),c+="c=IN IP4 0.0.0.0\r\na=inactive\r\na=mid:"+b.mid+"\r\n";else{if(b.stream){var g;"audio"===b.kind?g=b.stream.getAudioTracks()[0]:"video"===b.kind&&(g=b.stream.getVideoTracks()[0]);g&&15019<=h&&"video"===
b.kind&&!b.sendEncodingParameters[0].rtx&&(b.sendEncodingParameters[0].rtx={ssrc:b.sendEncodingParameters[0].ssrc+1})}f=d(b.localCapabilities,b.remoteCapabilities);!f.codecs.filter(function(a){return"rtx"===a.name.toLowerCase()}).length&&b.sendEncodingParameters[0].rtx&&delete b.sendEncodingParameters[0].rtx;c+=e(b,f,"answer",b.stream,a._dtlsRole);b.rtcpParameters&&b.rtcpParameters.reducedSize&&(c+="a=rtcp-rsize\r\n")}});var l=new f.RTCSessionDescription({type:"answer",sdp:c});return Promise.resolve(l)};
m.prototype.addIceCandidate=function(a){var c=this,d;return a&&void 0===a.sdpMLineIndex&&!a.sdpMid?Promise.reject(new TypeError("sdpMLineIndex or sdpMid required")):new Promise(function(e,f){if(c._remoteDescription)if(a&&""!==a.candidate){var h=a.sdpMLineIndex;if(a.sdpMid)for(var k=0;k<c.transceivers.length;k++)if(c.transceivers[k].mid===a.sdpMid){h=k;break}var l=c.transceivers[h];if(l){if(l.rejected)return e();k=0<Object.keys(a.candidate).length?g.parseCandidate(a.candidate):{};if("tcp"===k.protocol&&
(0===k.port||9===k.port)||k.component&&1!==k.component)return e();if((0===h||0<h&&l.iceTransport!==c.transceivers[0].iceTransport)&&!n(l.iceTransport,k))return f(b("OperationError","Can not add ICE candidate"));f=a.candidate.trim();0===f.indexOf("a=")&&(f=f.substr(2));d=g.getMediaSections(c._remoteDescription.sdp);d[h]+="a="+(k.type?f:"end-of-candidates")+"\r\n";c._remoteDescription.sdp=g.getDescription(c._remoteDescription.sdp)+d.join("")}else return f(b("OperationError","Can not add ICE candidate"))}else for(h=
0;h<c.transceivers.length&&(c.transceivers[h].rejected||(c.transceivers[h].iceTransport.addRemoteCandidate({}),d=g.getMediaSections(c._remoteDescription.sdp),d[h]+="a=end-of-candidates\r\n",c._remoteDescription.sdp=g.getDescription(c._remoteDescription.sdp)+d.join(""),!c.usingBundle));h++);else return f(b("InvalidStateError","Can not add ICE candidate without a remote description"));e()})};m.prototype.getStats=function(a){if(a&&a instanceof f.MediaStreamTrack){var c=null;this.transceivers.forEach(function(b){b.rtpSender&&
b.rtpSender.track===a?c=b.rtpSender:b.rtpReceiver&&b.rtpReceiver.track===a&&(c=b.rtpReceiver)});if(!c)throw b("InvalidAccessError","Invalid selector.");return c.getStats()}var d=[];this.transceivers.forEach(function(a){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach(function(b){a[b]&&d.push(a[b].getStats())})});return Promise.all(d).then(function(a){var b=new Map;a.forEach(function(a){a.forEach(function(a){b.set(a.id,a)})});return b})};["RTCRtpSender","RTCRtpReceiver",
"RTCIceGatherer","RTCIceTransport","RTCDtlsTransport"].forEach(function(a){if((a=f[a])&&a.prototype&&a.prototype.getStats){var b=a.prototype.getStats;a.prototype.getStats=function(){return b.apply(this).then(function(a){var b=new Map;Object.keys(a).forEach(function(c){var d=a[c];a[c].type={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[d.type]||d.type;b.set(c,a[c])});return b})}}});var y=["createOffer",
"createAnswer"];y.forEach(function(a){var b=m.prototype[a];m.prototype[a]=function(){var a=arguments;return"function"===typeof a[0]||"function"===typeof a[1]?b.apply(this,[arguments[2]]).then(function(b){"function"===typeof a[0]&&a[0].apply(null,[b])},function(b){"function"===typeof a[1]&&a[1].apply(null,[b])}):b.apply(this,arguments)}});y=["setLocalDescription","setRemoteDescription","addIceCandidate"];y.forEach(function(a){var b=m.prototype[a];m.prototype[a]=function(){var a=arguments;return"function"===
typeof a[1]||"function"===typeof a[2]?b.apply(this,arguments).then(function(){"function"===typeof a[1]&&a[1].apply(null)},function(b){"function"===typeof a[2]&&a[2].apply(null,[b])}):b.apply(this,arguments)}});["getStats"].forEach(function(a){var b=m.prototype[a];m.prototype[a]=function(){var a=arguments;return"function"===typeof a[1]?b.apply(this,arguments).then(function(){"function"===typeof a[1]&&a[1].apply(null)}):b.apply(this,arguments)}});return m}},{sdp:17}],17:[function(f,l,h){var e={generateIdentifier:function(){return Math.random().toString(36).substr(2,
10)}};e.localCName=e.generateIdentifier();e.splitLines=function(a){return a.trim().split("\n").map(function(a){return a.trim()})};e.splitSections=function(a){return a.split("\nm=").map(function(a,c){return(0<c?"m="+a:a).trim()+"\r\n"})};e.getDescription=function(a){return(a=e.splitSections(a))&&a[0]};e.getMediaSections=function(a){a=e.splitSections(a);a.shift();return a};e.matchPrefix=function(a,d){return e.splitLines(a).filter(function(a){return 0===a.indexOf(d)})};e.parseCandidate=function(a){a=
0===a.indexOf("a=candidate:")?a.substring(12).split(" "):a.substring(10).split(" ");for(var d={foundation:a[0],component:parseInt(a[1],10),protocol:a[2].toLowerCase(),priority:parseInt(a[3],10),ip:a[4],address:a[4],port:parseInt(a[5],10),type:a[7]},c=8;c<a.length;c+=2)switch(a[c]){case "raddr":d.relatedAddress=a[c+1];break;case "rport":d.relatedPort=parseInt(a[c+1],10);break;case "tcptype":d.tcpType=a[c+1];break;case "ufrag":d.ufrag=a[c+1];d.usernameFragment=a[c+1];break;default:d[a[c]]=a[c+1]}return d};
e.writeCandidate=function(a){var d=[];d.push(a.foundation);d.push(a.component);d.push(a.protocol.toUpperCase());d.push(a.priority);d.push(a.address||a.ip);d.push(a.port);var c=a.type;d.push("typ");d.push(c);"host"!==c&&a.relatedAddress&&a.relatedPort&&(d.push("raddr"),d.push(a.relatedAddress),d.push("rport"),d.push(a.relatedPort));a.tcpType&&"tcp"===a.protocol.toLowerCase()&&(d.push("tcptype"),d.push(a.tcpType));if(a.usernameFragment||a.ufrag)d.push("ufrag"),d.push(a.usernameFragment||a.ufrag);return"candidate:"+
d.join(" ")};e.parseIceOptions=function(a){return a.substr(14).split(" ")};e.parseRtpMap=function(a){a=a.substr(9).split(" ");var d={payloadType:parseInt(a.shift(),10)};a=a[0].split("/");d.name=a[0];d.clockRate=parseInt(a[1],10);d.channels=3===a.length?parseInt(a[2],10):1;d.numChannels=d.channels;return d};e.writeRtpMap=function(a){var d=a.payloadType;void 0!==a.preferredPayloadType&&(d=a.preferredPayloadType);var c=a.channels||a.numChannels||1;return"a=rtpmap:"+d+" "+a.name+"/"+a.clockRate+(1!==
c?"/"+c:"")+"\r\n"};e.parseExtmap=function(a){a=a.substr(9).split(" ");return{id:parseInt(a[0],10),direction:0<a[0].indexOf("/")?a[0].split("/")[1]:"sendrecv",uri:a[1]}};e.writeExtmap=function(a){return"a=extmap:"+(a.id||a.preferredId)+(a.direction&&"sendrecv"!==a.direction?"/"+a.direction:"")+" "+a.uri+"\r\n"};e.parseFmtp=function(a){for(var d={},c=a.substr(a.indexOf(" ")+1).split(";"),e=0;e<c.length;e++)a=c[e].trim().split("="),d[a[0].trim()]=a[1];return d};e.writeFmtp=function(a){var d="",c=a.payloadType;
void 0!==a.preferredPayloadType&&(c=a.preferredPayloadType);if(a.parameters&&Object.keys(a.parameters).length){var e=[];Object.keys(a.parameters).forEach(function(b){a.parameters[b]?e.push(b+"="+a.parameters[b]):e.push(b)});d+="a=fmtp:"+c+" "+e.join(";")+"\r\n"}return d};e.parseRtcpFb=function(a){a=a.substr(a.indexOf(" ")+1).split(" ");return{type:a.shift(),parameter:a.join(" ")}};e.writeRtcpFb=function(a){var d="",c=a.payloadType;void 0!==a.preferredPayloadType&&(c=a.preferredPayloadType);a.rtcpFeedback&&
a.rtcpFeedback.length&&a.rtcpFeedback.forEach(function(a){d+="a=rtcp-fb:"+c+" "+a.type+(a.parameter&&a.parameter.length?" "+a.parameter:"")+"\r\n"});return d};e.parseSsrcMedia=function(a){var d=a.indexOf(" "),c={ssrc:parseInt(a.substr(7,d-7),10)},e=a.indexOf(":",d);-1<e?(c.attribute=a.substr(d+1,e-d-1),c.value=a.substr(e+1)):c.attribute=a.substr(d+1);return c};e.parseSsrcGroup=function(a){a=a.substr(13).split(" ");return{semantics:a.shift(),ssrcs:a.map(function(a){return parseInt(a,10)})}};e.getMid=
function(a){if(a=e.matchPrefix(a,"a=mid:")[0])return a.substr(6)};e.parseFingerprint=function(a){a=a.substr(14).split(" ");return{algorithm:a[0].toLowerCase(),value:a[1]}};e.getDtlsParameters=function(a,d){return{role:"auto",fingerprints:e.matchPrefix(a+d,"a=fingerprint:").map(e.parseFingerprint)}};e.writeDtlsParameters=function(a,d){var c="a=setup:"+d+"\r\n";a.fingerprints.forEach(function(a){c+="a=fingerprint:"+a.algorithm+" "+a.value+"\r\n"});return c};e.parseCryptoLine=function(a){a=a.substr(9).split(" ");
return{tag:parseInt(a[0],10),cryptoSuite:a[1],keyParams:a[2],sessionParams:a.slice(3)}};e.writeCryptoLine=function(a){return"a=crypto:"+a.tag+" "+a.cryptoSuite+" "+("object"===typeof a.keyParams?e.writeCryptoKeyParams(a.keyParams):a.keyParams)+(a.sessionParams?" "+a.sessionParams.join(" "):"")+"\r\n"};e.parseCryptoKeyParams=function(a){if(0!==a.indexOf("inline:"))return null;a=a.substr(7).split("|");return{keyMethod:"inline",keySalt:a[0],lifeTime:a[1],mkiValue:a[2]?a[2].split(":")[0]:void 0,mkiLength:a[2]?
a[2].split(":")[1]:void 0}};e.writeCryptoKeyParams=function(a){return a.keyMethod+":"+a.keySalt+(a.lifeTime?"|"+a.lifeTime:"")+(a.mkiValue&&a.mkiLength?"|"+a.mkiValue+":"+a.mkiLength:"")};e.getCryptoParameters=function(a,d){return e.matchPrefix(a+d,"a=crypto:").map(e.parseCryptoLine)};e.getIceParameters=function(a,d){var c=e.matchPrefix(a+d,"a=ice-ufrag:")[0];a=e.matchPrefix(a+d,"a=ice-pwd:")[0];return c&&a?{usernameFragment:c.substr(12),password:a.substr(10)}:null};e.writeIceParameters=function(a){return"a=ice-ufrag:"+
a.usernameFragment+"\r\na=ice-pwd:"+a.password+"\r\n"};e.parseRtpParameters=function(a){for(var d={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},c=e.splitLines(a)[0].split(" "),f=3;f<c.length;f++){var b=c[f],g=e.matchPrefix(a,"a=rtpmap:"+b+" ")[0];if(g){g=e.parseRtpMap(g);var h=e.matchPrefix(a,"a=fmtp:"+b+" ");g.parameters=h.length?e.parseFmtp(h[0]):{};g.rtcpFeedback=e.matchPrefix(a,"a=rtcp-fb:"+b+" ").map(e.parseRtcpFb);d.codecs.push(g);switch(g.name.toUpperCase()){case "RED":case "ULPFEC":d.fecMechanisms.push(g.name.toUpperCase())}}}e.matchPrefix(a,
"a=extmap:").forEach(function(a){d.headerExtensions.push(e.parseExtmap(a))});return d};e.writeRtpDescription=function(a,d){var c="";c+="m="+a+" ";c+=0<d.codecs.length?"9":"0";c+=" UDP/TLS/RTP/SAVPF ";c+=d.codecs.map(function(a){return void 0!==a.preferredPayloadType?a.preferredPayloadType:a.payloadType}).join(" ")+"\r\n";c+="c=IN IP4 0.0.0.0\r\n";c+="a=rtcp:9 IN IP4 0.0.0.0\r\n";d.codecs.forEach(function(a){c+=e.writeRtpMap(a);c+=e.writeFmtp(a);c+=e.writeRtcpFb(a)});var f=0;d.codecs.forEach(function(a){a.maxptime>
f&&(f=a.maxptime)});0<f&&(c+="a=maxptime:"+f+"\r\n");c+="a=rtcp-mux\r\n";d.headerExtensions&&d.headerExtensions.forEach(function(a){c+=e.writeExtmap(a)});return c};e.parseRtpEncodingParameters=function(a){var d=[],c=e.parseRtpParameters(a),f=-1!==c.fecMechanisms.indexOf("RED"),b=-1!==c.fecMechanisms.indexOf("ULPFEC"),g=e.matchPrefix(a,"a=ssrc:").map(function(a){return e.parseSsrcMedia(a)}).filter(function(a){return"cname"===a.attribute}),h=0<g.length&&g[0].ssrc,l;g=e.matchPrefix(a,"a=ssrc-group:FID").map(function(a){return a.substr(17).split(" ").map(function(a){return parseInt(a,
10)})});0<g.length&&1<g[0].length&&g[0][0]===h&&(l=g[0][1]);c.codecs.forEach(function(a){"RTX"===a.name.toUpperCase()&&a.parameters.apt&&(a={ssrc:h,codecPayloadType:parseInt(a.parameters.apt,10)},h&&l&&(a.rtx={ssrc:l}),d.push(a),f&&(a=JSON.parse(JSON.stringify(a)),a.fec={ssrc:h,mechanism:b?"red+ulpfec":"red"},d.push(a)))});0===d.length&&h&&d.push({ssrc:h});var t=e.matchPrefix(a,"b=");t.length&&(t=0===t[0].indexOf("b=TIAS:")?parseInt(t[0].substr(7),10):0===t[0].indexOf("b=AS:")?950*parseInt(t[0].substr(5),
10)-16E3:void 0,d.forEach(function(a){a.maxBitrate=t}));return d};e.parseRtcpParameters=function(a){var d={},c=e.matchPrefix(a,"a=ssrc:").map(function(a){return e.parseSsrcMedia(a)}).filter(function(a){return"cname"===a.attribute})[0];c&&(d.cname=c.value,d.ssrc=c.ssrc);c=e.matchPrefix(a,"a=rtcp-rsize");d.reducedSize=0<c.length;d.compound=0===c.length;a=e.matchPrefix(a,"a=rtcp-mux");d.mux=0<a.length;return d};e.parseMsid=function(a){var d=e.matchPrefix(a,"a=msid:");if(1===d.length)return a=d[0].substr(7).split(" "),
{stream:a[0],track:a[1]};a=e.matchPrefix(a,"a=ssrc:").map(function(a){return e.parseSsrcMedia(a)}).filter(function(a){return"msid"===a.attribute});if(0<a.length)return a=a[0].value.split(" "),{stream:a[0],track:a[1]}};e.parseSctpDescription=function(a){var d=e.parseMLine(a),c=e.matchPrefix(a,"a=max-message-size:"),f;0<c.length&&(f=parseInt(c[0].substr(19),10));isNaN(f)&&(f=65536);c=e.matchPrefix(a,"a=sctp-port:");if(0<c.length)return{port:parseInt(c[0].substr(12),10),protocol:d.fmt,maxMessageSize:f};
if(0<e.matchPrefix(a,"a=sctpmap:").length)return a=e.matchPrefix(a,"a=sctpmap:")[0].substr(10).split(" "),{port:parseInt(a[0],10),protocol:a[1],maxMessageSize:f}};e.writeSctpDescription=function(a,d){a="DTLS/SCTP"!==a.protocol?["m="+a.kind+" 9 "+a.protocol+" "+d.protocol+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctp-port:"+d.port+"\r\n"]:["m="+a.kind+" 9 "+a.protocol+" "+d.port+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctpmap:"+d.port+" "+d.protocol+" 65535\r\n"];void 0!==d.maxMessageSize&&a.push("a=max-message-size:"+
d.maxMessageSize+"\r\n");return a.join("")};e.generateSessionId=function(){return Math.random().toString().substr(2,21)};e.writeSessionBoilerplate=function(a,d,c){d=void 0!==d?d:2;a=a?a:e.generateSessionId();return"v=0\r\no="+(c||"thisisadapterortc")+" "+a+" "+d+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"};e.writeMediaSection=function(a,d,c,f){d=e.writeRtpDescription(a.kind,d);d+=e.writeIceParameters(a.iceGatherer.getLocalParameters());d+=e.writeDtlsParameters(a.dtlsTransport.getLocalParameters(),"offer"===
c?"actpass":"active");d+="a=mid:"+a.mid+"\r\n";d=a.direction?d+("a="+a.direction+"\r\n"):a.rtpSender&&a.rtpReceiver?d+"a=sendrecv\r\n":a.rtpSender?d+"a=sendonly\r\n":a.rtpReceiver?d+"a=recvonly\r\n":d+"a=inactive\r\n";a.rtpSender&&(c="msid:"+f.id+" "+a.rtpSender.track.id+"\r\n",d=d+("a="+c)+("a=ssrc:"+a.sendEncodingParameters[0].ssrc+" "+c),a.sendEncodingParameters[0].rtx&&(d+="a=ssrc:"+a.sendEncodingParameters[0].rtx.ssrc+" "+c,d+="a=ssrc-group:FID "+a.sendEncodingParameters[0].ssrc+" "+a.sendEncodingParameters[0].rtx.ssrc+
"\r\n"));d+="a=ssrc:"+a.sendEncodingParameters[0].ssrc+" cname:"+e.localCName+"\r\n";a.rtpSender&&a.sendEncodingParameters[0].rtx&&(d+="a=ssrc:"+a.sendEncodingParameters[0].rtx.ssrc+" cname:"+e.localCName+"\r\n");return d};e.getDirection=function(a,d){a=e.splitLines(a);for(var c=0;c<a.length;c++)switch(a[c]){case "a=sendrecv":case "a=sendonly":case "a=recvonly":case "a=inactive":return a[c].substr(2)}return d?e.getDirection(d):"sendrecv"};e.getKind=function(a){return e.splitLines(a)[0].split(" ")[0].substr(2)};
e.isRejected=function(a){return"0"===a.split(" ",2)[1]};e.parseMLine=function(a){a=e.splitLines(a)[0].substr(2).split(" ");return{kind:a[0],port:parseInt(a[1],10),protocol:a[2],fmt:a.slice(3).join(" ")}};e.parseOLine=function(a){a=e.matchPrefix(a,"o=")[0].substr(2).split(" ");return{username:a[0],sessionId:a[1],sessionVersion:parseInt(a[2],10),netType:a[3],addressType:a[4],address:a[5]}};e.isValidSDP=function(a){if("string"!==typeof a||0===a.length)return!1;a=e.splitLines(a);for(var d=0;d<a.length;d++)if(2>
a[d].length||"="!==a[d].charAt(1))return!1;return!0};"object"===typeof l&&(l.exports=e)},{}]},{},[1])(1)});
